<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Admin Panel - ELX Properties</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/all.css">
    <link rel="stylesheet" href="css/mdb.min.css">
    <link rel="stylesheet" href="fonts/font.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="css/aos.css" rel="stylesheet">
    <link href="css/owl.carousel.min.css" rel="stylesheet">

    <!-- Bootstrap CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Popper.js for Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>


    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Select2 for searchable dropdowns -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0/dist/js/select2.min.js"></script>



    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="fonts/fontawesome-free-6.6.0-web/css/all.min.css">
    <script src="fonts/fontawesome-free-6.6.0-web/js/all.min.js"></script>

    <!-- Load jQuery first -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load DataTables CSS and JS after jQuery -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>


</head>

<body>
    <!--Main Navigation-->
    <header>
        <!-- Sidebar -->
        <nav id="sidebarMenu" class="collapse d-lg-block sidebar collapse bg-white">
            <div class="position-sticky sidebar-sticky">
                <div class="list-group list-group-flush mx-3 mt-4">
                    <a href="#" class="list-group-item list-group-item-action py-2 ripple"
                        onclick="showSection('navigation-bar-section')">
                        <i class="fas fa-tachometer-alt fa-fw me-3"></i><span>Dashboard</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-2 ripple"
                        onclick="showSection('section1')">
                        <i class="fas fa-chart-area fa-fw me-3"></i><span>Off-Plan Property</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-2 ripple"
                        onclick="showSection('Rent-Sale')">
                        <i class="fas fa-lock fa-fw me-3"></i><span>Rent/sale Property</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-2 ripple"
                        onclick="showSection('section2')">
                        <i class="fas fa-lock fa-fw me-3"></i><span>XML Upload</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-2 ripple"
                        onclick="showSection('ContactFormData')">
                        <i class="fas fa-lock fa-fw me-3"></i><span>Contact Form Data</span>
                    </a>
                    <!-- Logout Button -->
                    <a href="#" id="logoutBtn" class="list-group-item list-group-item-action py-2 ripple">
                        <i class="fas fa-sign-out-alt fa-fw me-3"></i><span>Logout</span>
                    </a>
                </div>
            </div>
        </nav>
        <!-- Sidebar -->

        <!-- Navbar -->
        <nav id="main-navbar" class="navbar navbar-expand-lg navbar-light bg-white fixed-top">
            <!-- Container wrapper -->
            <div class="container-fluid">
                <!-- Toggle button -->
                <button class="navbar-toggler" type="button" data-mdb-toggle="collapse" data-mdb-target="#sidebarMenu"
                    aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Brand -->
                <a class="navbar-brand" href="#">
                    <img src="images/logo.svg" height="25" alt="MDB Logo" loading="lazy" />
                </a>

                <!-- Right links -->
                <ul class="navbar-nav ms-auto d-flex flex-row">
                    <!-- Avatar -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle hidden-arrow d-flex align-items-center" href="#"
                            id="navbarDropdownMenuLink" role="button" data-mdb-toggle="dropdown" aria-expanded="false">
                            <img src="https://mdbcdn.b-cdn.net/img/Photos/Avatars/img (31).webp" class="rounded-circle"
                                height="22" alt="Avatar" loading="lazy" />
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item" href="#">My profile</a></li>
                            <li><a class="dropdown-item" href="#">Settings</a></li>
                            <!-- Logout button -->
                            <li><a id="logoutBtn" class="dropdown-item" href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- Container wrapper -->
        </nav>
        <!-- Navbar -->
    </header>
    <!--Main Navigation-->

    <!--Main layout-->
    <main style="margin-top: 58px;">
        <div class="container pt-4">
            <h1 class="text-center my-5">Manage ELX Website</h1>

            <!-- Navigation Bar Section -->
            <section id="navigation-bar-section" style="display:none" class="mb-5">
                <!-- Manage Top Regions -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Top Regions</h2>
                        <button onclick="openAddModal('topRegions')" class="btn btn-primary">Add New Region</button>
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>URL</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="top-regions-list-admin">
                            <!-- Data will be loaded here from Firestore -->
                        </tbody>
                    </table>
                </div>

                <!-- Manage Top Cities -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Top Cities</h2>
                        <button onclick="openAddModal('topCities')" class="btn btn-primary">Add New City</button>
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>URL</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="top-cities-list-admin">
                            <!-- Data will be loaded here from Firestore -->
                        </tbody>
                    </table>
                </div>

                <!-- Manage Property Types -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Property Types</h2>
                        <button onclick="openAddModal('propertyTypes')" class="btn btn-primary">Add New Property
                            Type</button>
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>URL</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="property-types-list-admin">
                            <!-- Data will be loaded here from Firestore -->
                        </tbody>
                    </table>
                </div>

                <!-- Manage Top Searches -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Top Searches</h2>
                        <button onclick="openAddModal('topSearches')" class="btn btn-primary">Add New Search</button>
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>URL</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="top-searches-list-admin">
                            <!-- Data will be loaded here from Firestore -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 1: Property Listings -->
            <section id="section1" class="mb-5 ps-lg-5 ps-md-4">
                <h2 class="mb-4">Off-Plan Property Listings</h2>
                <!-- Add New Property Form (Initially Hidden) -->
                <div id="add-property-form" class="card mb-4" style="display: none;">
                    <div class="card-body">
                        <form id="propertyListingForm">
                            <!-- Type Section -->
                            <div class="mb-4">
                                <h5>Type</h5>
                                <div class="row">
                                    <!-- Property Type -->
                                    <div class="col-md-6">
                                        <label for="propertyType" class="form-label">Property Type</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="propertyType"
                                                id="residential" value="Residential">
                                            <label class="form-check-label" for="residential">Residential</label>
                                            <input type="hidden" id="property-id">
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="propertyType"
                                                id="commercial" value="Commercial">
                                            <label class="form-check-label" for="commercial">Commercial</label>
                                        </div>
                                    </div>
                                    <!-- Transaction Type Section -->
                                    <div class="col-md-6">
                                        <label for="transactionType" class="form-label">Transaction Type</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="transactionType"
                                                id="rent" value="Rent" onclick="togglePricingSection()" disabled>
                                            <label class="form-check-label" for="rent">Rent</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="transactionType"
                                                id="sale" value="Sale" onclick="togglePricingSection()" checked>
                                            <label class="form-check-label" for="sale">Sale</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <!-- Specifications Section -->
                            <div class="mb-4">
                                <h5>Specifications</h5>
                                <div class="row g-3">
                                    <!-- Title Deeds -->
                                    <div class="col-md-6">
                                        <label for="titleDeeds" class="form-label">Title Deeds</label>
                                        <input type="text" class="form-control" id="titleDeeds" name="titleDeeds"
                                            placeholder="Enter title deeds">
                                    </div>

                                    <!-- Size -->
                                    <div class="col-md-6">
                                        <label for="size" class="form-label">Size (sqft)</label>
                                        <input type="number" class="form-control" id="size" name="size"
                                            placeholder="Enter size in sqft">
                                    </div>

                                    <!-- Bedrooms -->
                                    <div class="col-md-6">
                                        <label for="bedrooms" class="form-label">No of Bedrooms</label>
                                        <select class="form-select" id="bedrooms" name="bedrooms">
                                            <option selected>Select number of bedrooms</option>
                                        </select>
                                    </div>

                                    <!-- Bathrooms -->
                                    <div class="col-md-6">
                                        <label for="bathrooms" class="form-label">No of Bathrooms</label>
                                        <select class="form-select" id="bathrooms" name="bathrooms">
                                            <option selected>Select number of bathrooms</option>
                                        </select>
                                    </div>

                                    <!-- Furnishing Type -->
                                    <div class="col-md-6">
                                        <label for="furnishingType" class="form-label">Furnishing Type</label>
                                        <select class="form-select" id="furnishingType" name="furnishingType">
                                            <option selected>Select furnishing type</option>
                                        </select>
                                    </div>

                                    <!-- Parking Spaces -->
                                    <div class="col-md-6">
                                        <label for="parkingSpaces" class="form-label">No of Parking Spaces</label>
                                        <input type="number" class="form-control" id="parkingSpaces"
                                            name="parkingSpaces" placeholder="Enter number of parking spaces">
                                    </div>

                                    <!-- Plot Size -->
                                    <div class="col-md-6">
                                        <label for="plotSize" class="form-label">Total Plot Size (sqft)</label>
                                        <input type="number" class="form-control" id="plotSize" name="plotSize"
                                            placeholder="Enter plot size in sqft">
                                    </div>

                                    <!-- Built-Up Area -->
                                    <div class="col-md-6">
                                        <label for="builtUpArea" class="form-label">Built-up Area (sqft)</label>
                                        <input type="number" class="form-control" id="builtUpArea" name="builtUpArea"
                                            placeholder="Enter built-up area in sqft">
                                    </div>

                                    <!-- Property Type -->
                                    <div class="col-md-6">
                                        <label for="propertyType" class="form-label">Property Type</label>
                                        <select class="form-select" id="propertyType" name="propertyType">
                                            <option selected>Select property type</option>
                                        </select>
                                    </div>

                                    <!-- Property Status (visible only when Sale is selected) -->
                                    <div class="col-md-6" id="propertyStatusContainer" style="display: none;">
                                        <label for="propertyStatus" class="form-label">Property Status</label>
                                        <select class="form-select" id="propertyStatus" name="propertyStatus">
                                            <option selected>Select property status</option>
                                        </select>
                                    </div>
                                </div>

                            </div>

                            <!-- Pricing Section (for Rent) -->
                            <div id="rentPricingSection" class="card mt-4" style="display:none;">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-dollar-sign"></i> Rental Pricing</h5>
                                    <button class="btn btn-sm btn-outline-secondary" type="button"
                                        data-bs-toggle="collapse" data-bs-target="#rentPricingSectionContent"
                                        aria-expanded="true" aria-controls="rentPricingSectionContent">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                                <div id="rentPricingSectionContent" class="collapse show">
                                    <div class="card-body">
                                        <!-- Rental Prices -->
                                        <div class="mb-4">
                                            <h6>Rental Prices*</h6>
                                            <div class="row g-3">
                                                <div class="col-md-3">
                                                    <label for="price_per_year" class="form-label">Yearly Price
                                                        (AED)</label>
                                                    <div class="input-group">
                                                        <input type="number" id="price_per_year" name="price_per_year"
                                                            class="form-control" placeholder="Enter yearly price">
                                                        <span class="input-group-text">AED</span>
                                                    </div>
                                                    <div class="form-check mt-2">
                                                        <input class="form-check-input" type="radio"
                                                            name="default_price" value="year" id="defaultYear">
                                                        <label class="form-check-label"
                                                            for="defaultYear">Default</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <label for="price_per_month" class="form-label">Monthly Price
                                                        (AED)</label>
                                                    <div class="input-group">
                                                        <input type="number" id="price_per_month" name="price_per_month"
                                                            class="form-control" placeholder="Enter monthly price">
                                                        <span class="input-group-text">AED</span>
                                                    </div>
                                                    <div class="form-check mt-2">
                                                        <input class="form-check-input" type="radio"
                                                            name="default_price" value="month" id="defaultMonth">
                                                        <label class="form-check-label"
                                                            for="defaultMonth">Default</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <label for="price_per_week" class="form-label">Weekly Price
                                                        (AED)</label>
                                                    <div class="input-group">
                                                        <input type="number" id="price_per_week" name="price_per_week"
                                                            class="form-control" placeholder="Enter weekly price">
                                                        <span class="input-group-text">AED</span>
                                                    </div>
                                                    <div class="form-check mt-2">
                                                        <input class="form-check-input" type="radio"
                                                            name="default_price" value="week" id="defaultWeek">
                                                        <label class="form-check-label"
                                                            for="defaultWeek">Default</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <label for="price_per_day" class="form-label">Daily Price
                                                        (AED)</label>
                                                    <div class="input-group">
                                                        <input type="number" id="price_per_day" name="price_per_day"
                                                            class="form-control" placeholder="Enter daily price">
                                                        <span class="input-group-text">AED</span>
                                                    </div>
                                                    <div class="form-check mt-2">
                                                        <input class="form-check-input" type="radio"
                                                            name="default_price" value="day" id="defaultDay">
                                                        <label class="form-check-label" for="defaultDay">Default</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Cheques -->
                                        <div class="mb-4">
                                            <h6>Cheques</h6>
                                            <label for="cheques" class="form-label">Number of Cheques</label>
                                            <select id="cheques" name="cheques" class="form-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                                <option value="11">11</option>
                                                <option value="12">12</option>
                                            </select>
                                        </div>

                                        <!-- Financial Status -->
                                        <div class="mb-4">
                                            <h6>Financial Status</h6>
                                            <label for="financial_status" class="form-label">Select Financial
                                                Status</label>
                                            <select id="financial_status" name="financial_status" class="form-select">
                                                <option value="mortgage">Mortgaged</option>
                                                <option value="cash">Cash</option>
                                            </select>
                                        </div>

                                        <!-- Service Charges -->
                                        <div class="mb-4">
                                            <h6>Service Charges (Monthly)</h6>
                                            <label for="service_charges" class="form-label">Service Charges
                                                (AED)</label>
                                            <div class="input-group">
                                                <input type="number" id="service_charges" name="service_charges"
                                                    class="form-control" placeholder="Enter monthly service charges">
                                                <span class="input-group-text">AED</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Sale Price Section -->
                            <div id="salePricingSection" class="card mt-4" style="display:none;">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-dollar-sign"></i> Sale Pricing
                                    </h5>
                                    <button class="btn btn-sm btn-outline-secondary" type="button"
                                        data-bs-toggle="collapse" data-bs-target="#salePricingSectionContent"
                                        aria-expanded="true" aria-controls="salePricingSectionContent">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                                <div id="salePricingSectionContent" class="collapse show">
                                    <div class="card-body">
                                        <!-- Sale Price Input Field -->
                                        <div class="mb-4">
                                            <label for="sale_price" class="form-label">Price <span
                                                    class="text-danger">*</span></label>
                                            <div class="input-group">
                                                <input type="number" id="sale_price" name="sale_price"
                                                    class="form-control" placeholder="Enter sale price" required>
                                                <span class="input-group-text">AED</span>
                                            </div>
                                            <div class="form-text text-danger d-none" id="salePriceError">This field is
                                                required.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Two-Column Layout for Description, Media, Amenities, Floor Plan, and Documents Sections -->
                            <div class="row">
                                <div class="col-lg-6">
                                    <!-- Description Section -->
                                    <div class="card mb-4">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5><i class="fas fa-info-circle"></i> Description</h5>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="languageToggle"
                                                    onchange="toggleLanguage()">
                                                <label class="form-check-label" for="languageToggle">Arabic</label>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div id="englishContent">
                                                <!-- Title in English -->
                                                <div class="mb-3">
                                                    <label for="englishTitle" class="form-label">Title (English)</label>
                                                    <input type="text" class="form-control" id="englishTitle"
                                                        name="englishTitle" placeholder="Enter title in English">
                                                </div>
                                                <!-- Description in English -->
                                                <div class="mb-3">
                                                    <label for="englishDescription" class="form-label">Description
                                                        (English)</label>
                                                    <textarea class="form-control" id="englishDescription"
                                                        name="englishDescription" rows="4"
                                                        placeholder="Enter description in English"></textarea>
                                                </div>
                                            </div>
                                            <div id="arabicContent" style="display: none;">
                                                <!-- Title in Arabic -->
                                                <div class="mb-3">
                                                    <label for="arabicTitle" class="form-label">عنوان (Arabic
                                                        Title)</label>
                                                    <input type="text" class="form-control" id="arabicTitle"
                                                        name="arabicTitle" placeholder="أدخل العنوان بالعربية">
                                                </div>
                                                <!-- Description in Arabic -->
                                                <div class="mb-3">
                                                    <label for="arabicDescription" class="form-label">الوصف (Arabic
                                                        Description)</label>
                                                    <textarea class="form-control" id="arabicDescription"
                                                        name="arabicDescription" rows="4"
                                                        placeholder="أدخل الوصف بالعربية"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Amenities Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-clipboard-list"></i> Amenities</h5>
                                        </div>
                                        <div class="card-body text-center">
                                            <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                                data-bs-target="#amenitiesModal">Add Amenities</button>
                                        </div>
                                        <div id="selected-amenities" class="card-body">
                                            <!-- Selected amenities will appear here -->
                                        </div>
                                    </div>

                                    <!-- Management Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-user-tie"></i> Management</h5>
                                        </div>
                                        <div class="card-body">
                                            <!-- Reference Input -->
                                            <div class="mb-4">
                                                <label for="reference" class="form-label">Reference</label>
                                                <input type="text" class="form-control" id="reference" name="reference"
                                                    placeholder="Enter reference ID">
                                            </div>
                                            <!-- Assigned User Dropdown -->
                                            <div class="mb-4">
                                                <label for="assignedUser" class="form-label">Assigned User</label>
                                                <select id="assignedUser" name="assignedUser"
                                                    class="form-select searchable-dropdown">
                                                    <!-- Options will be dynamically generated -->
                                                </select>
                                            </div>
                                            <!-- Owner Dropdown -->
                                            <div class="mb-4">
                                                <label for="owner" class="form-label">Owner</label>
                                                <select id="owner" name="owner" class="form-select searchable-dropdown">
                                                    <!-- Options will be dynamically generated -->
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Property Permit Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-file-alt"></i> Property Permit</h5>
                                        </div>
                                        <div class="card-body">
                                            <!-- Radio Buttons for RERA and DTCM -->
                                            <div class="mb-4">
                                                <label for="permitType" class="form-label">Permit Type</label>
                                                <div id="permitType">
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="radio" name="permitType"
                                                            id="rera" value="RERA" onclick="togglePermitFields()">
                                                        <label class="form-check-label" for="rera">RERA</label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="radio" name="permitType"
                                                            id="dtcm" value="DTCM" onclick="togglePermitFields()">
                                                        <label class="form-check-label" for="dtcm">DTCM</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Conditional Text Box for RERA Listing Number -->
                                            <div class="mb-4" id="reraListingNoField" style="display: none;">
                                                <label for="reraListingNo" class="form-label">RERA Listing No</label>
                                                <input type="text" class="form-control" id="reraListingNo"
                                                    name="reraListingNo" placeholder="Enter RERA Listing No">
                                            </div>
                                            <!-- Conditional Text Box and Date Pickers for DTCM Permit -->
                                            <div id="dtcmFields" style="display: none;">
                                                <!-- DTCM Permit Number -->
                                                <div class="mb-4">
                                                    <label for="dtcmPermitNo" class="form-label">DTCM Permit No</label>
                                                    <input type="text" class="form-control" id="dtcmPermitNo"
                                                        name="dtcmPermitNo" placeholder="Enter DTCM Permit No">
                                                </div>
                                                <!-- Date Pickers for From and To Dates -->
                                                <div class="mb-4">
                                                    <label for="permitFromDate" class="form-label">From</label>
                                                    <input type="date" class="form-control" id="permitFromDate"
                                                        name="permitFromDate">
                                                </div>
                                                <div class="mb-4">
                                                    <label for="permitToDate" class="form-label">To</label>
                                                    <input type="date" class="form-control" id="permitToDate"
                                                        name="permitToDate">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <!-- Media Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-camera"></i> Media</h5>
                                        </div>
                                        <div class="card-body">
                                            <!-- Notice -->
                                            <div class="alert alert-warning mt-3" role="alert">
                                                <strong>Notice:</strong> Please upload images in our recommended 4:3
                                                ratio. Any duplicate images will affect your Quality Score.
                                            </div>
                                            <!-- Image Upload Section -->
                                            <div class="mb-4">
                                                <label for="propertyImages" class="form-label">Upload Images</label>
                                                <input type="file" class="form-control" id="propertyImages"
                                                    name="propertyImages" multiple accept="image/*"
                                                    onchange="handleImageUpload(this)">
                                                <div id="imageThumbnails" class="mt-3 d-flex flex-wrap">
                                                    <!-- Thumbnails will be shown here after upload -->
                                                </div>
                                            </div>
                                            <!-- 360 URL Link -->
                                            <div class="mb-3">
                                                <label for="tour360Url" class="form-label">360° Tour URL</label>
                                                <input type="url" class="form-control" id="tour360Url" name="tour360Url"
                                                    placeholder="Enter 360° tour URL">
                                            </div>
                                            <!-- Video Tour URL Link -->
                                            <div class="mb-3">
                                                <label for="videoTourUrl" class="form-label">Video Tour URL</label>
                                                <input type="url" class="form-control" id="videoTourUrl"
                                                    name="videoTourUrl" placeholder="Enter video tour URL">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Floor Plan Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-map"></i> Floor Plan</h5>
                                        </div>
                                        <div class="card-body">
                                            <!-- Notice -->
                                            <div class="alert alert-warning mt-3" role="alert">
                                                <strong>Notice:</strong> Please upload floor plan documents in PDF
                                                format. Ensure the documents are clear and properly labeled.
                                            </div>
                                            <!-- Floor Plan Upload Section -->
                                            <div class="mb-4">
                                                <label for="floorPlanDocuments" class="form-label">Upload Floor
                                                    Plan</label>
                                                <input type="file" class="form-control" id="floorPlanDocuments"
                                                    name="floorPlanDocuments" multiple accept=".pdf"
                                                    onchange="handleFloorPlanUpload(this)">
                                                <div id="floorPlanThumbnails" class="mt-3 d-flex flex-wrap">
                                                    <!-- Thumbnails or file names will be shown here after upload -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Availability Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-calendar-alt"></i> Availability</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="btn-group-toggle mb-3" data-toggle="buttons">
                                                <label class="btn btn-outline-success" id="available-option">
                                                    <input type="radio" name="availability" id="available"
                                                        value="available"> Available
                                                </label>
                                                <label class="btn btn-outline-info" id="under-offer-option">
                                                    <input type="radio" name="availability" id="under-offer"
                                                        value="under offer"> Under Offer
                                                </label>
                                                <label class="btn btn-outline-warning" id="reserved-option">
                                                    <input type="radio" name="availability" id="reserved"
                                                        value="reserved"> Reserved
                                                </label>
                                                <label class="btn btn-outline-secondary is-disabled" id="rented-option">
                                                    <input type="radio" name="availability" id="rented" value="rented"
                                                        disabled> Rented
                                                </label>
                                            </div>
                                            <!-- Date Picker for Available From -->
                                            <div class="form-group">
                                                <label for="availableFrom">Available from:</label>
                                                <input type="date" class="form-control" id="availableFrom"
                                                    name="availableFrom">
                                            </div>
                                            <!-- Exclusivity Checkbox -->
                                            <div class="form-check mt-3">
                                                <input type="checkbox" class="form-check-input" id="exclusivity"
                                                    name="exclusivity">
                                                <label class="form-check-label" for="exclusivity">Exclusivity</label>
                                            </div>
                                            <!-- Start Date and Expiry Date (Initially Hidden) -->
                                            <div id="exclusivity-dates" style="display: none;">
                                                <div class="form-group mt-3">
                                                    <label for="startDate">Start Date:</label>
                                                    <input type="date" class="form-control" id="startDate"
                                                        name="startDate">
                                                </div>
                                                <div class="form-group mt-3">
                                                    <label for="expiryDate">Expiry Date:</label>
                                                    <input type="date" class="form-control" id="expiryDate"
                                                        name="expiryDate">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Documents Section -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-file-alt"></i> Documents</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-4">
                                                <label for="propertyDocuments" class="form-label">Upload
                                                    Documents</label>
                                                <input type="file" class="form-control" id="propertyDocuments"
                                                    name="propertyDocuments" multiple
                                                    accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt"
                                                    onchange="handleDocumentUpload(this)">
                                                <div id="documentThumbnails" class="mt-3 d-flex flex-wrap">
                                                    <!-- Document thumbnails or icons will be shown here after upload -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div id="location-section" class="card mt-4">
                                <div class="card-header">
                                    <h5><i class="fas fa-map-marker-alt"></i> Location</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <!-- Map -->
                                        <div class="col-md-6">
                                            <div id="map"></div>
                                        </div>
                                        <!-- Searchable Dropdown and Additional Fields -->
                                        <div class="col-md-6">
                                            <!-- Searchable Dropdown for Location -->
                                            <div class="mb-4">
                                                <label for="locationSearch" class="form-label">Search Location</label>
                                                <input type="text" id="locationSearch" name="locationSearch"
                                                    class="form-control"
                                                    placeholder="Search for a building, villa, or office in the UAE">
                                            </div>
                                            <!-- Notice about typing exact location -->
                                            <div class="alert alert-info">
                                                <strong>Notice:</strong> Please ensure you type the exact location with
                                                details to maintain quality score.
                                            </div>
                                            <!-- Unit Number -->
                                            <div class="mb-4">
                                                <label for="unitNumber" class="form-label">Unit Number</label>
                                                <input type="text" class="form-control" id="unitNumber"
                                                    name="unitNumber" placeholder="Enter Unit Number">
                                            </div>
                                            <!-- Hidden inputs to store lat and lng -->
                                            <input type="hidden" id="geoLat" name="geoLat">
                                            <input type="hidden" id="geoLng" name="geoLng">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Save Button -->
                            <div class="text-center mt-4">
                                <button id="savePropertyListing" type="submit" class="btn btn-primary btn-lg">Save
                                    Property Listing</button>

                            </div>

                            <!-- Placeholder for messages -->
                            <div id="formMessage" class="text-center mt-4"></div>
                        </form>
                    </div>
                </div>

                <!-- Button to Show Form -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <button onclick="togglePropertyForm()" class="btn btn-primary">Add New Property</button>
                </div>

                <!-- Existing Properties Table -->
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Sl No</th>
                            <th>Title</th>
                            <th>Property Type</th>
                            <th>Transaction Type</th>
                            <th>Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="property-listings-admin">
                        <!-- Data will be loaded here from Firestore -->
                    </tbody>
                </table>
            </section>
            <!-- Section 3: Display Propery detils rent sale  -->
            <section id="Rent-Sale" class="mb-5 container">
                <h2 class="mb-4 text-center">Rent/Sale Property Details</h2>
                <!-- Existing Properties Table -->
                <table id="rent_sale_propertyTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Sl No</th>
                            <th>Title</th>
                            <th>Property Type</th>
                            <th>Transaction Type</th>
                            <th>Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="rent_sale_property-listings-admin">
                        <!-- Data will be loaded here from Firestore -->
                    </tbody>
                </table>
            </section>



            <!-- Section 2 -->
            <section id="section2" class="mb-5" style="display:none;">
                <div class="container">
                    <h2>Upload or Paste XML Data</h2>

                    <!-- Option 1: Upload XML File -->
                    <div class="mb-3">
                        <label for="xmlFile" class="form-label">Upload XML File:</label>
                        <input type="file" class="form-control" id="xmlFile" accept=".xml">
                    </div>

                    <!-- Option 2: Paste XML Content -->
                    <div class="mb-3">
                        <label for="xmlContent" class="form-label">Or Paste XML Content:</label>
                        <textarea class="form-control" id="xmlContent" rows="10"
                            placeholder="Paste XML content here"></textarea>
                    </div>

                    <!-- Button to Start Parsing and Insertion -->
                    <button class="btn btn-primary" id="addPropertiesButton">Add Properties</button>

                    <!-- Progress Bar -->
                    <div class="progress mt-3" style="height: 25px;">
                        <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
                    </div>

                    <!-- Display Added Properties -->
                    <div id="resultContainer" class="mt-3">
                        <h4>Added Properties:</h4>
                        <ul id="addedPropertiesList" class="list-group"></ul>
                    </div>
                </div>

            </section>
            <!-- Section 3: Display Submitted Contact Form Data -->
            <section id="ContactFormData" class="mb-5 container">
                <h2 class="mb-4 text-center">Submitted Enquiries</h2>
                <div class="table-responsive">
                    <table id="enquiries-table" class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Client Message</th>
                                <th>Community</th>
                                <th>Sub Community</th>
                                <th>Building</th>
                                <th>Reference Number</th>
                                <th>Link</th>
                                <th>IP Address</th>
                            </tr>
                        </thead>
                        <tbody id="enquiries-table-body">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>



        </div>
    </main>
    <!--Main layout-->

    <!-- Modal for Add/Edit -->
    <div class="modal fade" id="collectionModal" tabindex="-1" aria-labelledby="collectionModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="collectionModalLabel">Add/Edit Entry</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="collection-form">
                        <div class="mb-3">
                            <label for="entry-name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="entry-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="entry-url" class="form-label">URL</label>
                            <input type="url" class="form-control" id="entry-url" required>
                        </div>
                        <input type="hidden" id="entry-id">
                        <input type="hidden" id="collection-type">
                        <button type="submit" class="btn btn-primary">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Add/Edit Property -->
    <div class="modal fade" id="propertyModal" tabindex="-1" aria-labelledby="propertyModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="propertyModalLabel">Add/Edit Property</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="property-form">
                        <div class="mb-3">
                            <label for="property-title" class="form-label">Title</label>
                            <input type="text" class="form-control" id="property-title" required>
                        </div>
                        <div class="mb-3">
                            <label for="property-type" class="form-label">Property Type</label>
                            <input type="text" class="form-control" id="property-type" required>
                        </div>
                        <div class="mb-3">
                            <label for="transaction-type" class="form-label">Transaction Type</label>
                            <input type="text" class="form-control" id="transaction-type" required>
                        </div>
                        <div class="mb-3">
                            <label for="property-price" class="form-label">Price</label>
                            <input type="number" class="form-control" id="property-price" required>
                        </div>
                        <input type="hidden" id="property-id">
                        <button type="submit" class="btn btn-primary">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Amenities Modal -->
    <div class="modal fade" id="amenitiesModal" tabindex="-1" aria-labelledby="amenitiesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="amenitiesModalLabel">Select Amenities</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="amenities-list" class="amenities-list">
                        <!-- Amenities buttons will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Modal for Editing Offplan Property -->
    <div class="modal fade" id="editPropertyModal" tabindex="-1" aria-labelledby="editPropertyModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPropertyModalLabel">Edit Property Listing</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editPropertyForm">
                        <!-- Type Section -->
                        <div class="mb-4">
                            <h5>Type</h5>
                            <div class="row">
                                <!-- Property Type -->
                                <div class="col-md-6">
                                    <label for="editPropertyType" class="form-label">Property Type</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editPropertyType"
                                            id="editResidential" value="Residential">
                                        <input type="hidden" id="editPropertyId">

                                        <label class="form-check-label" for="editResidential">Residential</label>
                                        <input type="hidden" id="editPropertyId">
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editPropertyType"
                                            id="editCommercial" value="Commercial">
                                        <label class="form-check-label" for="editCommercial">Commercial</label>
                                    </div>
                                </div>
                                <!-- Transaction Type Section -->
                                <div class="col-md-6">
                                    <label for="editTransactionType" class="form-label">Transaction Type</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editTransactionType"
                                            id="editRent" value="Rent" onclick="togglePricingSection()">
                                        <label class="form-check-label" for="editRent">Rent</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editTransactionType"
                                            id="editSale" value="Sale" checked onclick="togglePricingSection()">

                                        <label class="form-check-label" for="editSale">Sale</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Specifications Section -->
                        <div class="mb-4">
                            <h5>Specifications</h5>
                            <div class="row g-3">
                                <!-- Title Deeds -->
                                <div class="col-md-6">
                                    <label for="editProperty_TitleDeeds" class="form-label">Title Deeds</label>
                                    <input type="text" class="form-control" id="editProperty_TitleDeeds"
                                        name="editProperty_TitleDeeds" placeholder="Enter title deeds">
                                </div>

                                <!-- Size -->
                                <div class="col-md-6">
                                    <label for="editProperty_Size" class="form-label">Size (sqft)</label>
                                    <input type="number" class="form-control" id="editProperty_Size"
                                        name="editProperty_Size" placeholder="Enter size in sqft">
                                </div>

                                <!-- Bedrooms -->
                                <div class="col-md-6">
                                    <label for="editProperty_Bedrooms" class="form-label">No of Bedrooms</label>
                                    <select class="form-select" id="editProperty_Bedrooms" name="editProperty_Bedrooms">
                                        <option selected>Select number of bedrooms</option>
                                    </select>
                                </div>

                                <!-- Bathrooms -->
                                <div class="col-md-6">
                                    <label for="editProperty_Bathrooms" class="form-label">No of Bathrooms</label>
                                    <select class="form-select" id="editProperty_Bathrooms"
                                        name="editProperty_Bathrooms">
                                        <option selected>Select number of bathrooms</option>
                                    </select>
                                </div>

                                <!-- Furnishing Type -->
                                <div class="col-md-6">
                                    <label for="editProperty_FurnishingType" class="form-label">Furnishing Type</label>
                                    <select class="form-select" id="editProperty_FurnishingType"
                                        name="editProperty_FurnishingType">
                                        <option selected>Select furnishing type</option>
                                    </select>
                                </div>

                                <!-- Parking Spaces -->
                                <div class="col-md-6">
                                    <label for="editProperty_ParkingSpaces" class="form-label">No of Parking
                                        Spaces</label>
                                    <input type="number" class="form-control" id="editProperty_ParkingSpaces"
                                        name="editProperty_ParkingSpaces" placeholder="Enter number of parking spaces">
                                </div>

                                <!-- Plot Size -->
                                <div class="col-md-6">
                                    <label for="editProperty_PlotSize" class="form-label">Total Plot Size (sqft)</label>
                                    <input type="number" class="form-control" id="editProperty_PlotSize"
                                        name="editProperty_PlotSize" placeholder="Enter plot size in sqft">
                                </div>

                                <!-- Built-Up Area -->
                                <div class="col-md-6">
                                    <label for="editProperty_BuiltUpArea" class="form-label">Built-up Area
                                        (sqft)</label>
                                    <input type="number" class="form-control" id="editProperty_BuiltUpArea"
                                        name="editProperty_BuiltUpArea" placeholder="Enter built-up area in sqft">
                                </div>
                                <!-- Property Type -->
                                <div class="col-md-6">
                                    <label for="propertyType" class="form-label">Property Type</label>
                                    <select class="form-select" id="propertyType" name="propertyType">
                                        <option selected>Select property type</option>
                                    </select>
                                </div>

                                <!-- Property Status (for Sale) -->
                                <div class="col-md-6" id="editPropertyStatusContainer" style="display: none;">
                                    <label for="editProperty_Status" class="form-label">Property Status</label>
                                    <select class="form-select" id="editProperty_Status" name="editProperty_Status">
                                        <option selected>Select property status</option>
                                    </select>
                                </div>
                            </div>
                        </div>


                        <!-- Pricing Section (for Rent) -->
                        <div id="editRentPricingSection" class="card mt-4" style="display:none;">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-dollar-sign"></i> Rental Pricing</h5>
                                <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#editRentPricingSectionContent" aria-expanded="true"
                                    aria-controls="editRentPricingSectionContent">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div id="editRentPricingSectionContent" class="collapse show">
                                <div class="card-body">
                                    <!-- Rental Prices -->
                                    <div class="mb-4">
                                        <h6>Rental Prices*</h6>
                                        <div class="row g-3">
                                            <div class="col-md-3">
                                                <label for="editPricePerYear" class="form-label">Yearly Price
                                                    (AED)</label>
                                                <div class="input-group">
                                                    <input type="number" id="editPricePerYear" name="editPricePerYear"
                                                        class="form-control" placeholder="Enter yearly price">
                                                    <span class="input-group-text">AED</span>
                                                </div>
                                                <div class="form-check mt-2">
                                                    <input class="form-check-input" type="radio" name="editDefaultPrice"
                                                        value="year" id="editDefaultYear">
                                                    <label class="form-check-label"
                                                        for="editDefaultYear">Default</label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label for="editPricePerMonth" class="form-label">Monthly Price
                                                    (AED)</label>
                                                <div class="input-group">
                                                    <input type="number" id="editPricePerMonth" name="editPricePerMonth"
                                                        class="form-control" placeholder="Enter monthly price">
                                                    <span class="input-group-text">AED</span>
                                                </div>
                                                <div class="form-check mt-2">
                                                    <input class="form-check-input" type="radio" name="editDefaultPrice"
                                                        value="month" id="editDefaultMonth">
                                                    <label class="form-check-label"
                                                        for="editDefaultMonth">Default</label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label for="editPricePerWeek" class="form-label">Weekly Price
                                                    (AED)</label>
                                                <div class="input-group">
                                                    <input type="number" id="editPricePerWeek" name="editPricePerWeek"
                                                        class="form-control" placeholder="Enter weekly price">
                                                    <span class="input-group-text">AED</span>
                                                </div>
                                                <div class="form-check mt-2">
                                                    <input class="form-check-input" type="radio" name="editDefaultPrice"
                                                        value="week" id="editDefaultWeek">
                                                    <label class="form-check-label"
                                                        for="editDefaultWeek">Default</label>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <label for="editPricePerDay" class="form-label">Daily Price
                                                    (AED)</label>
                                                <div class="input-group">
                                                    <input type="number" id="editPricePerDay" name="editPricePerDay"
                                                        class="form-control" placeholder="Enter daily price">
                                                    <span class="input-group-text">AED</span>
                                                </div>
                                                <div class="form-check mt-2">
                                                    <input class="form-check-input" type="radio" name="editDefaultPrice"
                                                        value="day" id="editDefaultDay">
                                                    <label class="form-check-label" for="editDefaultDay">Default</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Cheques -->
                                    <div class="mb-4">
                                        <h6>Cheques</h6>
                                        <label for="editCheques" class="form-label">Number of Cheques</label>
                                        <select id="editCheques" name="editCheques" class="form-select">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                            <option value="11">11</option>
                                            <option value="12">12</option>
                                        </select>
                                    </div>

                                    <!-- Financial Status -->
                                    <div class="mb-4">
                                        <h6>Financial Status</h6>
                                        <label for="editFinancialStatus" class="form-label">Select Financial
                                            Status</label>
                                        <select id="editFinancialStatus" name="editFinancialStatus" class="form-select">
                                            <option value="mortgage">Mortgaged</option>
                                            <option value="cash">Cash</option>
                                        </select>
                                    </div>

                                    <!-- Service Charges -->
                                    <div class="mb-4">
                                        <h6>Service Charges (Monthly)</h6>
                                        <label for="editServiceCharges" class="form-label">Service Charges (AED)</label>
                                        <div class="input-group">
                                            <input type="number" id="editServiceCharges" name="editServiceCharges"
                                                class="form-control" placeholder="Enter monthly service charges">
                                            <span class="input-group-text">AED</span>
                                        </div>
                                    </div>

                                    <!-- Rental Period and Price On Application -->
                                    <div class="mb-4">
                                        <h6>Rental Period</h6>
                                        <label for="editRentalPeriod" class="form-label">Select Rental Period</label>
                                        <select id="editRentalPeriod" name="editRentalPeriod" class="form-select">
                                            <option value="Y">Yearly</option>
                                            <option value="M">Monthly</option>
                                        </select>
                                    </div>

                                    <div class="mb-4">
                                        <h6>Price On Application</h6>
                                        <label for="editPriceOnApplication" class="form-label">Price On
                                            Application</label>
                                        <select id="editPriceOnApplication" name="editPriceOnApplication"
                                            class="form-select">
                                            <option value="No">No</option>
                                            <option value="Yes">Yes</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sale Price Section -->
                        <div id="editSalePricingSection" class="card mt-4" style="display:none;">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-dollar-sign"></i> Sale Pricing
                                </h5>
                                <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#editSalePricingSectionContent" aria-expanded="true"
                                    aria-controls="editSalePricingSectionContent">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div id="editSalePricingSectionContent" class="collapse show">
                                <div class="card-body">
                                    <!-- Sale Price Input Field -->
                                    <div class="mb-4">
                                        <label for="editSalePrice" class="form-label">Price <span
                                                class="text-danger">*</span></label>
                                        <div class="input-group">
                                            <input type="number" id="editSalePrice" name="editSalePrice"
                                                class="form-control" placeholder="Enter sale price" required>
                                            <span class="input-group-text">AED</span>
                                        </div>
                                        <div class="form-text text-danger d-none" id="editSalePriceError">This field is
                                            required.</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Two-Column Layout for Description, Media, Amenities, Floor Plan, and Documents Sections -->
                        <div class="row">
                            <div class="col-lg-6">
                                <!-- Description Section -->
                                <div class="card mb-4">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5><i class="fas fa-info-circle"></i> Description</h5>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="editLanguageToggle"
                                                onchange="toggleLanguage()">
                                            <label class="form-check-label" for="editLanguageToggle">Arabic</label>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div id="editEnglishContent">
                                            <!-- Title in English -->
                                            <div class="mb-3">
                                                <label for="editEnglishTitle" class="form-label">Title (English)</label>
                                                <input type="text" class="form-control" id="editEnglishTitle"
                                                    name="editEnglishTitle" placeholder="Enter title in English">
                                            </div>
                                            <!-- Description in English -->
                                            <div class="mb-3">
                                                <label for="editEnglishDescription" class="form-label">Description
                                                    (English)</label>
                                                <textarea class="form-control" id="editEnglishDescription"
                                                    name="editEnglishDescription" rows="4"
                                                    placeholder="Enter description in English"></textarea>
                                            </div>
                                        </div>
                                        <div id="editArabicContent" style="display: none;">
                                            <!-- Title in Arabic -->
                                            <div class="mb-3">
                                                <label for="editArabicTitle" class="form-label">عنوان (Arabic
                                                    Title)</label>
                                                <input type="text" class="form-control" id="editArabicTitle"
                                                    name="editArabicTitle" placeholder="أدخل العنوان بالعربية">
                                            </div>
                                            <!-- Description in Arabic -->
                                            <div class="mb-3">
                                                <label for="editArabicDescription" class="form-label">الوصف (Arabic
                                                    Description)</label>
                                                <textarea class="form-control" id="editArabicDescription"
                                                    name="editArabicDescription" rows="4"
                                                    placeholder="أدخل الوصف بالعربية"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Amenities Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-clipboard-list"></i> Amenities</h5>
                                    </div>
                                    <div class="card-body text-center">
                                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                            data-bs-target="#amenitiesModal">Add Amenities</button>
                                    </div>
                                    <div id="editSelectedAmenities" class="card-body">
                                        <!-- Selected amenities will appear here -->
                                    </div>
                                </div>

                                <!-- Management Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-user-tie"></i> Management</h5>
                                    </div>
                                    <div class="card-body">
                                        <!-- Reference Input -->
                                        <div class="mb-4">
                                            <label for="editReference" class="form-label">Reference</label>
                                            <input type="text" class="form-control" id="editReference"
                                                name="editReference" placeholder="Enter reference ID">
                                        </div>
                                        <!-- Assigned User Dropdown -->
                                        <div class="mb-4">
                                            <label for="editAssignedUser" class="form-label">Assigned User</label>
                                            <select id="editAssignedUser" name="editAssignedUser"
                                                class="form-select searchable-dropdown">
                                                <!-- Options will be dynamically generated -->
                                            </select>
                                        </div>
                                        <!-- Owner Dropdown -->
                                        <div class="mb-4">
                                            <label for="editOwner" class="form-label">Owner</label>
                                            <select id="editOwner" name="editOwner"
                                                class="form-select searchable-dropdown">
                                                <!-- Options will be dynamically generated -->
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Property Permit Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-file-alt"></i> Property Permit</h5>
                                    </div>
                                    <div class="card-body">
                                        <!-- Radio Buttons for RERA and DTCM -->
                                        <div class="mb-4">
                                            <label for="editPermitType" class="form-label">Permit Type</label>
                                            <div id="editPermitType">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="editPermitType"
                                                        id="editRera" value="RERA" onclick="togglePermitFields()">
                                                    <label class="form-check-label" for="editRera">RERA</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="editPermitType"
                                                        id="editDtcm" value="DTCM" onclick="togglePermitFields()">
                                                    <label class="form-check-label" for="editDtcm">DTCM</label>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Conditional Text Box for RERA Listing Number -->
                                        <div class="mb-4" id="editReraListingNoField" style="display: none;">
                                            <label for="editReraListingNo" class="form-label">RERA Listing No</label>
                                            <input type="text" class="form-control" id="editReraListingNo"
                                                name="editReraListingNo" placeholder="Enter RERA Listing No">
                                        </div>
                                        <!-- Conditional Text Box and Date Pickers for DTCM Permit -->
                                        <div id="editDtcmFields" style="display: none;">
                                            <!-- DTCM Permit Number -->
                                            <div class="mb-4">
                                                <label for="editDtcmPermitNo" class="form-label">DTCM Permit No</label>
                                                <input type="text" class="form-control" id="editDtcmPermitNo"
                                                    name="editDtcmPermitNo" placeholder="Enter DTCM Permit No">
                                            </div>
                                            <!-- Date Pickers for From and To Dates -->
                                            <div class="mb-4">
                                                <label for="editPermitFromDate" class="form-label">From</label>
                                                <input type="date" class="form-control" id="editPermitFromDate"
                                                    name="editPermitFromDate">
                                            </div>
                                            <div class="mb-4">
                                                <label for="editPermitToDate" class="form-label">To</label>
                                                <input type="date" class="form-control" id="editPermitToDate"
                                                    name="editPermitToDate">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <!-- Media Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-camera"></i> Media</h5>
                                    </div>
                                    <div class="card-body">
                                        <!-- Notice -->
                                        <div class="alert alert-warning mt-3" role="alert">
                                            <strong>Notice:</strong> Please upload images in our recommended 4:3
                                            ratio. Any duplicate images will affect your Quality Score.
                                        </div>
                                        <!-- Image Upload Section -->
                                        <div class="mb-4">
                                            <label for="editPropertyImages" class="form-label">Upload Images</label>
                                            <input type="file" class="form-control" id="editPropertyImages"
                                                name="editPropertyImages" multiple accept="image/*"
                                                onchange="handleImageUpload(this)">
                                            <div id="editImageThumbnails" class="mt-3 d-flex flex-wrap">
                                                <!-- Thumbnails will be shown here after upload -->
                                            </div>
                                        </div>
                                        <!-- 360 URL Link -->
                                        <div class="mb-3">
                                            <label for="editTour360Url" class="form-label">360° Tour URL</label>
                                            <input type="url" class="form-control" id="editTour360Url"
                                                name="editTour360Url" placeholder="Enter 360° tour URL">
                                        </div>
                                        <!-- Video Tour URL Link -->
                                        <div class="mb-3">
                                            <label for="editVideoTourUrl" class="form-label">Video Tour URL</label>
                                            <input type="url" class="form-control" id="editVideoTourUrl"
                                                name="editVideoTourUrl" placeholder="Enter video tour URL">
                                        </div>
                                    </div>
                                </div>

                                <!-- Floor Plan Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-map"></i> Floor Plan</h5>
                                    </div>
                                    <div class="card-body">
                                        <!-- Notice -->
                                        <div class="alert alert-warning mt-3" role="alert">
                                            <strong>Notice:</strong> Please upload floor plan documents in PDF
                                            format. Ensure the documents are clear and properly labeled.
                                        </div>
                                        <!-- Floor Plan Upload Section -->
                                        <div class="mb-4">
                                            <label for="editFloorPlanDocuments" class="form-label">Upload Floor
                                                Plan</label>
                                            <input type="file" class="form-control" id="editFloorPlanDocuments"
                                                name="editFloorPlanDocuments" multiple accept=".pdf"
                                                onchange="handleFloorPlanUpload(this)">
                                            <div id="editFloorPlanThumbnails" class="mt-3 d-flex flex-wrap">
                                                <!-- Thumbnails or file names will be shown here after upload -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Availability Section edit -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-calendar-alt"></i> Availability</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="btn-group-toggle mb-3" data-toggle="buttons">
                                            <label class="btn btn-outline-success" id="editAvailableOption">
                                                <input type="radio" name="editAvailability" id="editAvailable"
                                                    value="available"> Available
                                            </label>
                                            <label class="btn btn-outline-info" id="editUnderOfferOption">
                                                <input type="radio" name="editAvailability" id="editUnderOffer"
                                                    value="under offer"> Under Offer
                                            </label>
                                            <label class="btn btn-outline-warning" id="editReservedOption">
                                                <input type="radio" name="editAvailability" id="editReserved"
                                                    value="reserved"> Reserved
                                            </label>
                                            <label class="btn btn-outline-secondary is-disabled" id="editRentedOption">
                                                <input type="radio" name="editAvailability" id="editRented"
                                                    value="rented" disabled> Rented
                                            </label>
                                        </div>
                                        <!-- Date Picker for Available From -->
                                        <div class="form-group">
                                            <label for="editAvailableFrom">Available from:</label>
                                            <input type="date" class="form-control" id="editAvailableFrom"
                                                name="editAvailableFrom">
                                        </div>
                                        <!-- Exclusivity Checkbox -->
                                        <div class="form-check mt-3">
                                            <input type="checkbox" class="form-check-input" id="editExclusivity"
                                                name="editExclusivity">
                                            <label class="form-check-label" for="editExclusivity">Exclusivity</label>
                                        </div>
                                        <!-- Start Date and Expiry Date (Initially Hidden) -->
                                        <div id="editExclusivityDates" style="display: none;">
                                            <div class="form-group mt-3">
                                                <label for="editStartDate">Start Date:</label>
                                                <input type="date" class="form-control" id="editStartDate"
                                                    name="editStartDate">
                                            </div>
                                            <div class="form-group mt-3">
                                                <label for="editExpiryDate">Expiry Date:</label>
                                                <input type="date" class="form-control" id="editExpiryDate"
                                                    name="editExpiryDate">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Documents Section -->
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5><i class="fas fa-file-alt"></i> Documents</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-4">
                                            <label for="editPropertyDocuments" class="form-label">Upload
                                                Documents</label>
                                            <input type="file" class="form-control" id="editPropertyDocuments"
                                                name="editPropertyDocuments" multiple
                                                accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt"
                                                onchange="handleDocumentUpload(this)">
                                            <div id="editDocumentThumbnails" class="mt-3 d-flex flex-wrap">
                                                <!-- Document thumbnails or icons will be shown here after upload -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Location Section -->
                        <div id="editLocationSection" class="card mt-4">
                            <div class="card-header">
                                <h5><i class="fas fa-map-marker-alt"></i> Location</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <!-- Map -->
                                    <div class="col-md-6">
                                        <div id="editMap" style="height: 300px;"></div> <!-- Ensure correct height -->
                                    </div>
                                    <!-- Searchable Dropdown and Additional Fields -->
                                    <div class="col-md-6">
                                        <!-- Searchable Dropdown for Location -->
                                        <div class="mb-4">
                                            <label for="editLocationSearch" class="form-label">Search Location</label>
                                            <input type="text" id="editLocationSearch" name="editLocationSearch"
                                                class="form-control"
                                                placeholder="Search for a building, villa, or office in the UAE">
                                        </div>
                                        <!-- Notice about typing exact location -->
                                        <div class="alert alert-info">
                                            <strong>Notice:</strong> Please ensure you type the exact location with
                                            details to maintain quality score.
                                        </div>
                                        <!-- Unit Number -->
                                        <div class="mb-4">
                                            <label for="editUnitNumber" class="form-label">Unit Number</label>
                                            <input type="text" class="form-control" id="editUnitNumber"
                                                name="editUnitNumber" placeholder="Enter Unit Number">
                                        </div>
                                        <!-- Hidden inputs to store lat and lng -->
                                        <input type="hidden" id="editGeoLat" name="editGeoLat">
                                        <input type="hidden" id="editGeoLng" name="editGeoLng">
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- Save Button -->
                        <div class="text-center mt-4">
                            <button id="saveEditedPropertyListing" type="submit" class="btn btn-primary btn-lg">Save
                                Changes</button>
                        </div>

                        <!-- Placeholder for messages -->
                        <div id="editFormMessage" class="text-center mt-4"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal for Editing RentSale Property -->
    <div class="modal fade" id="editRentSalePropertyModal" tabindex="-1"
        aria-labelledby="editRentSalePropertyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editRentSalePropertyModalLabel">Edit Property Listing</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editRentSalePropertyForm">
                        <!-- Type Section -->
                        <div class="mb-4">
                            <h5>Type</h5>
                            <div class="row">
                                <!-- Property Type -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyType" class="form-label">Property Type</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editRentSalePropertyType"
                                            id="editRentSaleResidential" value="Residential">
                                        <label class="form-check-label"
                                            for="editRentSaleResidential">Residential</label>
                                        <input type="hidden" id="editRentSalePropertyId" value="">

                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editRentSalePropertyType"
                                            id="editRentSaleCommercial" value="Commercial">
                                        <label class="form-check-label" for="editRentSaleCommercial">Commercial</label>
                                    </div>
                                </div>
                                <!-- Transaction Type -->
                                <div class="col-md-6">
                                    <label for="editRentSaleTransactionType" class="form-label">Transaction Type</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editRentSaleTransactionType"
                                            id="editRentSaleRent" value="Rent" onclick="toggleRentSalePricingSection()">
                                        <label class="form-check-label" for="editRentSaleRent">Rent</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="editRentSaleTransactionType"
                                            id="editRentSaleSale" value="Sale" checked
                                            onclick="toggleRentSalePricingSection()">
                                        <label class="form-check-label" for="editRentSaleSale">Sale</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Specifications Section -->
                        <div class="mb-4">
                            <h5>Specifications</h5>
                            <div class="row g-3">
                                <!-- 
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyTitleDeeds" class="form-label">Title Deeds</label>
                                    <input type="text" class="form-control" id="editRentSalePropertyTitleDeeds"
                                        name="editRentSalePropertyTitleDeeds" placeholder="Enter title deeds">
                                </div>Title Deeds -->

                                <!-- Size -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertySize" class="form-label">Size (sqft)</label>
                                    <input type="number" class="form-control" id="editRentSalePropertySize"
                                        name="editRentSalePropertySize" placeholder="Enter size in sqft">
                                </div>

                                <!-- Bedrooms -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyBedrooms" class="form-label">No of Bedrooms</label>
                                    <select class="form-select" id="editRentSalePropertyBedrooms"
                                        name="editRentSalePropertyBedrooms">
                                        <option selected>Select number of bedrooms</option>
                                    </select>
                                </div>

                                <!-- Bathrooms -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyBathrooms" class="form-label">No of
                                        Bathrooms</label>
                                    <select class="form-select" id="editRentSalePropertyBathrooms"
                                        name="editRentSalePropertyBathrooms">
                                        <option selected>Select number of bathrooms</option>
                                    </select>
                                </div>

                                <!-- Furnishing Type -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyFurnishingType" class="form-label">Furnishing
                                        Type</label>
                                    <select class="form-select" id="editRentSalePropertyFurnishingType"
                                        name="editRentSalePropertyFurnishingType">
                                        <option selected>Select furnishing type</option>
                                    </select>
                                </div>

                                <!-- Parking Spaces -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyParkingSpaces" class="form-label">No of Parking
                                        Spaces</label>
                                    <input type="number" class="form-control" id="editRentSalePropertyParkingSpaces"
                                        name="editRentSalePropertyParkingSpaces"
                                        placeholder="Enter number of parking spaces">
                                </div>

                                <!-- Plot Size -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyPlotSize" class="form-label">Total Plot Size
                                        (sqft)</label>
                                    <input type="number" class="form-control" id="editRentSalePropertyPlotSize"
                                        name="editRentSalePropertyPlotSize" placeholder="Enter plot size in sqft">
                                </div>

                                <!-- Built-Up Area -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyBuiltUpArea" class="form-label">Built-up Area
                                        (sqft)</label>
                                    <input type="number" class="form-control" id="editRentSalePropertyBuiltUpArea"
                                        name="editRentSalePropertyBuiltUpArea"
                                        placeholder="Enter built-up area in sqft">
                                </div>
                                <!-- Property Type -->
                                <div class="col-md-6">
                                    <label for="editRentSalePropertyTypeDropdown" class="form-label">Property
                                        Type</label>
                                    <select class="form-select" id="editRentSalePropertyTypeDropdown"
                                        name="editRentSalePropertyTypeDropdown">
                                        <option selected>Select property type</option>
                                        <option value="Residential">Residential</option>
                                        <option value="Commercial">Commercial</option>
                                    </select>
                                </div>

                                <!-- Property Status (for Sale) -->
                                <div class="col-md-6" id="editRentSalePropertyStatusContainer" style="display: none;">
                                    <label for="editRentSalePropertyStatus" class="form-label">Property Status</label>
                                    <select class="form-select" id="editRentSalePropertyStatus"
                                        name="editRentSalePropertyStatus">
                                        <option selected>Select property status</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Pricing Section (for Rent and Sale) -->
                        <div id="editRentSalePricingSection" class="card mt-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-dollar-sign"></i> Pricing</h5>
                                <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#editRentSalePricingSectionContent" aria-expanded="true"
                                    aria-controls="editRentSalePricingSectionContent">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div id="editRentSalePricingSectionContent" class="collapse show">
                                <div class="card-body">
                                    <!-- Sale Price -->
                                    <div class="mb-4">
                                        <label for="editRentSaleSalePrice" class="form-label">Price (AED)</label>
                                        <input type="number" class="form-control" id="editRentSaleSalePrice"
                                            name="editRentSaleSalePrice" placeholder="Enter sale price">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Description Section -->
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5><i class="fas fa-info-circle"></i> Description</h5>
                            </div>
                            <div class="card-body">
                                <div id="editRentSaleEnglishContent">
                                    <div class="mb-3">
                                        <label for="editRentSaleEnglishTitle" class="form-label">Title (English)</label>
                                        <input type="text" class="form-control" id="editRentSaleEnglishTitle"
                                            name="editRentSaleEnglishTitle" placeholder="Enter title in English">
                                    </div>
                                    <div class="mb-3">
                                        <label for="editRentSaleEnglishDescription" class="form-label">Description
                                            (English)</label>
                                        <textarea class="form-control" id="editRentSaleEnglishDescription"
                                            name="editRentSaleEnglishDescription" rows="4"
                                            placeholder="Enter description in English"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Media Section -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-camera"></i> Media</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label for="editRentSaleImages" class="form-label">Upload Images</label>
                                    <input type="file" class="form-control" id="editRentSaleImages"
                                        name="editRentSaleImages" multiple accept="image/*"
                                        onchange="handleImageUpload(this)">
                                    <div id="editRentSaleImageThumbnails" class="mt-3 d-flex flex-wrap"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Amenities Section 
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-clipboard-list"></i> Amenities</h5>
                            </div>
                            <div class="card-body text-center">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#amenitiesModal">Add Amenities</button>
                                <div id="editRentSaleSelectedAmenities" class="mt-3"></div>
                            </div>
                        </div>-->

                        <!-- Floor Plan Section -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-map"></i> Floor Plan</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label for="editRentSaleFloorPlanDocuments" class="form-label">Upload Floor
                                        Plan</label>
                                    <input type="file" class="form-control" id="editRentSaleFloorPlanDocuments"
                                        name="editRentSaleFloorPlanDocuments" multiple
                                        accept=".pdf,.jpg,.jpeg,.png,.gif" onchange="handleFloorPlanUpload(this)">
                                    <div id="editRentSaleFloorPlanThumbnails" class="mt-3 d-flex flex-wrap"></div>
                                </div>
                            </div>
                        </div>


                        <!-- Documents Section -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-file-alt"></i> Documents</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label for="editRentSaleDocuments" class="form-label">Upload Documents</label>
                                    <input type="file" class="form-control" id="editRentSaleDocuments"
                                        name="editRentSaleDocuments" multiple
                                        accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt">
                                    <div id="editRentSaleDocumentThumbnails" class="mt-3 d-flex flex-wrap"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Location Section -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-map-marker-alt"></i> Location</h5>
                            </div>
                            <div class="card-body">
                                <div class="row d-flex align-items-stretch">
                                    <!-- Map Display -->
                                    <div class="col-md-6 d-flex flex-column">
                                        <div id="editRentSaleMap" style="height: 100%; min-height: 350px;"></div>
                                    </div>
                                    <!-- Location Input Fields -->
                                    <div class="col-md-6">
                                        <!-- Search Location -->
                                        <label for="editRentSaleLocationSearch" class="form-label">Search
                                            Location</label>
                                        <input type="text" id="editRentSaleLocationSearch"
                                            name="editRentSaleLocationSearch" class="form-control"
                                            placeholder="Search for a building, villa, or office in the UAE">

                                        <!-- Community -->
                                        <label for="editRentSaleCommunity" class="form-label mt-3">Community</label>
                                        <input type="text" class="form-control" id="editRentSaleCommunity"
                                            name="editRentSaleCommunity" placeholder="Enter Community">

                                        <!-- Sub-Community -->
                                        <label for="editRentSaleSubCommunity"
                                            class="form-label mt-3">Sub-Community</label>
                                        <input type="text" class="form-control" id="editRentSaleSubCommunity"
                                            name="editRentSaleSubCommunity" placeholder="Enter Sub-Community">

                                        <!-- Property Name -->
                                        <label for="editRentSalePropertyName" class="form-label mt-3">Property
                                            Name</label>
                                        <input type="text" class="form-control" id="editRentSalePropertyName"
                                            name="editRentSalePropertyName" placeholder="Enter Property Name">

                                        <!-- Hidden Fields for Latitude and Longitude -->
                                        <input type="hidden" id="editRentSaleGeoLat" name="editRentSaleGeoLat">
                                        <input type="hidden" id="editRentSaleGeoLng" name="editRentSaleGeoLng">
                                    </div>
                                </div>
                            </div>
                        </div>



                        <!-- Management Section -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-user-tie"></i> Management</h5>
                            </div>
                            <div class="card-body">
                                <!-- Agent Name -->
                                <div class="mb-4">
                                    <label for="editRentSaleAgentName" class="form-label">Agent Name</label>
                                    <input type="text" class="form-control" id="editRentSaleAgentName"
                                        name="editRentSaleAgentName" placeholder="Enter agent name">
                                </div>
                                <!-- Agent Email -->
                                <div class="mb-4">
                                    <label for="editRentSaleAgentEmail" class="form-label">Agent Email</label>
                                    <input type="email" class="form-control" id="editRentSaleAgentEmail"
                                        name="editRentSaleAgentEmail" placeholder="Enter agent email">
                                </div>
                                <!-- Agent Phone -->
                                <div class="mb-4">
                                    <label for="editRentSaleAgentPhone" class="form-label">Agent Phone</label>
                                    <input type="tel" class="form-control" id="editRentSaleAgentPhone"
                                        name="editRentSaleAgentPhone" placeholder="Enter agent phone">
                                </div>
                                <!-- Agent License Number -->
                                <div class="mb-4">
                                    <label for="editRentSaleAgentLicenseNo" class="form-label">Agent License
                                        Number</label>
                                    <input type="text" class="form-control" id="editRentSaleAgentLicenseNo"
                                        name="editRentSaleAgentLicenseNo" placeholder="Enter agent license number">
                                </div>
                                <!-- Agent Photo Upload -->
                                <div class="mb-4">
                                    <label for="editRentSaleAgentPhoto" class="form-label">Agent Photo</label>
                                    <input type="file" class="form-control" id="editRentSaleAgentPhoto"
                                        name="editRentSaleAgentPhoto" accept="image/*"
                                        onchange="previewAgentPhoto(event)">
                                    <img id="editRentSaleAgentPhotoPreview"
                                        style="display:none; width: 150px; height: auto; margin-top: 10px;"
                                        alt="Agent Photo Preview">
                                </div>
                            </div>
                        </div>

                        <!-- Save Button -->
                        <div class="text-center mt-4">
                            <button id="saveEditedRentSalePropertyListing" type="button"
                                class="btn btn-primary btn-lg">Save Changes</button>
                            <!-- Loading bar (initially hidden) -->
                            <div id="loadingIndicator" class="spinner-border text-primary mt-3" role="status"
                                style="display: none;">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>

                        <!-- Placeholder for acknowledgment messages -->
                        <div id="editRentSaleFormMessage" class="text-center mt-4"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>




    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <!-- Firebase JS SDK (Version 8) -->

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>


    <!-- Custom Scripts -->
    <script>

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDhhHH2tK4y5oB9__yqJd_3yFUyy7ls5CM",
            authDomain: "elxproperties.firebaseapp.com",
            databaseURL: "https://elxproperties-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "elxproperties",
            storageBucket: "elxproperties.appspot.com",
            messagingSenderId: "250975584396",
            appId: "1:250975584396:web:a68528b30098952a313ba9",
            measurementId: "G-PYYQLQ34JY"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Check if the user is logged in
        auth.onAuthStateChanged((user) => {
            if (!user) {
                // If not logged in, redirect to login.html
                window.location.href = 'login.html';
            }
        });

        // Logout functionality
        const logoutBtn = document.getElementById('logoutBtn');
        logoutBtn.addEventListener('click', () => {
            auth.signOut().then(() => {
                window.location.href = 'login.html';
            }).catch((error) => {
                console.error('Logout Error:', error);
            });
        });

        // Function to show selected section
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
            });

            // Get the section element by ID
            const section = document.getElementById(sectionId);

            // Check if the section exists before trying to show it
            if (section) {
                section.style.display = 'block';  // Show the selected section
            } else {
                console.error(`Section with ID '${sectionId}' not found.`);
            }
        }


        document.addEventListener('DOMContentLoaded', function () {
            const exclusivityCheckbox = document.getElementById('exclusivity');
            const exclusivityDates = document.getElementById('exclusivity-dates');
            togglePricingSection();
            exclusivityCheckbox.addEventListener('change', function () {
                exclusivityDates.style.display = this.checked ? 'block' : 'none';
            });

            const buttons = document.querySelectorAll('.btn-group-toggle label');
            const hiddenInput = document.querySelector('input[name="availability"]');

            buttons.forEach(button => {
                button.addEventListener('click', function () {
                    buttons.forEach(btn => btn.classList.remove('active', 'btn-primary', 'btn-info', 'btn-warning', 'btn-secondary', 'btn-success'));
                    this.classList.add('active');
                    this.classList.add(`btn-${this.classList.contains('btn-outline-success') ? 'success' :
                        this.classList.contains('btn-outline-info') ? 'info' :
                            this.classList.contains('btn-outline-warning') ? 'warning' :
                                'secondary'}`);
                    hiddenInput.value = this.querySelector('input').value;
                });
            });
        });

        // Load admin data for regions, cities, property types, and searches
        function loadAdminData() {
            loadCollectionData('topRegions', 'top-regions-list-admin');
            loadCollectionData('topCities', 'top-cities-list-admin');
            loadCollectionData('propertyTypes', 'property-types-list-admin');
            loadCollectionData('topSearches', 'top-searches-list-admin');
        }

        // Load data from Firestore collections
        function loadCollectionData(collectionName, elementId) {
            db.collection(collectionName).get().then((querySnapshot) => {
                let collectionHTML = '';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    collectionHTML += `
                    <tr>
                        <td>${data.name}</td>
                        <td>${data.url}</td>
                        <td>
                            <button onclick="editEntry('${collectionName}', '${doc.id}', '${data.name}', '${data.url}')" class="btn btn-sm btn-warning">Edit</button>
                            <button onclick="deleteEntry('${collectionName}', '${doc.id}')" class="btn btn-sm btn-danger">Delete</button>
                        </td>
                    </tr>
                `;
                });
                document.getElementById(elementId).innerHTML = collectionHTML;
            }).catch(error => {
                console.error('Error loading data: ', error);
                alert('Failed to load data. Please try again.');
            });
        }

        // Handle add/edit operations in the modal
        const collectionModal = new bootstrap.Modal(document.getElementById('collectionModal'));
        const collectionForm = document.getElementById('collection-form');
        const entryNameInput = document.getElementById('entry-name');
        const entryUrlInput = document.getElementById('entry-url');
        const entryIdInput = document.getElementById('entry-id');
        const collectionTypeInput = document.getElementById('collection-type');

        function openAddModal(collectionType) {
            collectionForm.reset();
            entryIdInput.value = '';
            collectionTypeInput.value = collectionType;
            collectionModal.show();
        }

        function editEntry(collectionType, id, name, url) {
            entryNameInput.value = name;
            entryUrlInput.value = url;
            entryIdInput.value = id;
            collectionTypeInput.value = collectionType;
            collectionModal.show();
        }

        function deleteEntry(collectionType, id) {
            if (confirm('Do you really want to delete this entry?')) {
                db.collection(collectionType).doc(id).delete().then(() => {
                    loadAdminData();
                }).catch(error => {
                    console.error('Error deleting entry: ', error);
                    alert('Failed to delete entry. Please try again.');
                });
            }
        }

        collectionForm.addEventListener('submit', function (event) {
            event.preventDefault();
            const name = entryNameInput.value;
            const url = entryUrlInput.value;
            const entryId = entryIdInput.value;
            const collectionType = collectionTypeInput.value;

            if (entryId) {
                // Update existing entry
                db.collection(collectionType).doc(entryId).set({
                    name,
                    url
                }).then(() => {
                    collectionModal.hide();
                    loadAdminData();
                }).catch(error => {
                    console.error('Error updating entry: ', error);
                    alert('Failed to update entry. Please try again.');
                });
            } else {
                // Add new entry
                db.collection(collectionType).add({
                    name,
                    url
                }).then(() => {
                    collectionModal.hide();
                    loadAdminData();
                }).catch(error => {
                    console.error('Error adding entry: ', error);
                    alert('Failed to add entry. Please try again.');
                });
            }
        });

        // Load property listings
        document.addEventListener('DOMContentLoaded', loadPropertyListings);

        function loadPropertyListings() {
            // Query Firestore to only get documents where offplan == true
            db.collection('propertyListings')
                .where('offplan', '==', true)  // Filter for offplan == true
                .get()
                .then((querySnapshot) => {
                    let propertiesHTML = '';
                    let count = 0;
                    querySnapshot.forEach((doc) => {
                        count++;
                        const data = doc.data();
                        const price = data.pricing?.price || 'N/A';

                        propertiesHTML += `
                <tr>
                    <td>${count}</td>
                    <td>${data.title}</td>
                    <td>${data.offeringType}</td>
                    <td>${data.transactionType}</td>
                    <td>${price}</td>
                    <td>
                        <button onclick="editPropertyListings('${doc.id}')" class="btn btn-sm btn-warning">Edit</button>
                        <button onclick="deleteProperty('${doc.id}')" class="btn btn-sm btn-danger">Delete</button>
                    </td>
                </tr>
            `;
                    });

                    // Update the table with filtered properties
                    document.getElementById('property-listings-admin').innerHTML = propertiesHTML;
                })
                .catch(error => {
                    console.error('Error loading property listings: ', error);
                    alert('Failed to load property listings. Please try again.');
                });
        }

        function togglePropertyForm() {
            const form = document.getElementById('add-property-form');
            form.style.display = form.style.display === 'none' || form.style.display === '' ? 'block' : 'none';
            document.getElementById('propertyListingForm').reset();
            document.getElementById('savePropertyListing').textContent = 'Save Property Listing';
            document.getElementById('property-id').value = '';
        }

        // Define dropdownData at the beginning of the script
        const dropdownData = {
            bedrooms: [
                { value: 0, label: "Studio" },
                { value: 1, label: "1" },
                { value: 2, label: "2" },
                { value: 3, label: "3" },
                { value: 4, label: "4" },
                { value: 5, label: "5" },
            ],
            bathrooms: [
                { value: 1, label: "1" },
                { value: 2, label: "2" },
                { value: 3, label: "3" },
                { value: 4, label: "4" },
                { value: 5, label: "5" },
            ],
            furnishingType: [
                { value: "Unfurnished", label: "Unfurnished" },
                { value: "Semi-furnished", label: "Semi-furnished" },
                { value: "Furnished", label: "Furnished" },
            ],
            propertyType: [
                { value: "Apartment / Flat", label: "Apartment / Flat" },
                { value: "Bungalow", label: "Bungalow" },
                { value: "Compound", label: "Compound" },
                { value: "Duplex", label: "Duplex" },
                { value: "Full Floor", label: "Full Floor" },
                { value: "Half Floor", label: "Half Floor" },
                { value: "Land / Plot", label: "Land / Plot" },
                { value: "Penthouse", label: "Penthouse" },
                { value: "Townhouse", label: "Townhouse" },
                { value: "Villa / House", label: "Villa / House" },
                { value: "Whole Building", label: "Whole Building" },
                { value: "Short Term / Hotel Apartment", label: "Short Term / Hotel Apartment" },
                { value: "Labor Camp", label: "Labor Camp" },
                { value: "Bulk Units", label: "Bulk Units" },
                { value: "Warehouse", label: "Warehouse" },
                { value: "Factory", label: "Factory" },
                { value: "Office Space", label: "Office Space" },
                { value: "Retail", label: "Retail" },
                { value: "Plot", label: "Plot" },
                { value: "Shop", label: "Shop" },
                { value: "Show Room", label: "Show Room" },
                { value: "Staff Accommodation", label: "Staff Accommodation" }
            ],
            propertyStatus: [
                { value: "Off-Plan Primary", label: "Off-Plan Primary" },
                { value: "Off-Plan Secondary", label: "Off-Plan Secondary" },
                { value: "Ready Primary", label: "Ready Primary" },
                { value: "Ready Secondary", label: "Ready Secondary" }
            ]
        };

        function populateOwnersDropdown(selectedOwner) {
            const ownerDropdown = document.getElementById('editOwner');

            if (ownerDropdown) {
                ownerDropdown.innerHTML = ''; // Clear any existing options

                const owners = [
                    { value: 'owner1', label: 'John Doe' },
                    { value: 'owner2', label: 'Jane Smith' },
                    { value: 'owner3', label: 'Company XYZ' }
                ];

                owners.forEach(owner => {
                    const option = document.createElement('option');
                    option.value = owner.value;
                    option.textContent = owner.label;
                    ownerDropdown.appendChild(option);
                });

                // Set the selected value
                if (selectedOwner) {
                    ownerDropdown.value = selectedOwner;
                }
            } else {
                console.error('Owner dropdown element not found');
            }
        }

        // Call this function after the DOM is ready or when you have fetched the data
        function populateAssignedUsersDropdown(selectedUser) {
            const assignedUserDropdown = document.getElementById('editAssignedUser');

            if (assignedUserDropdown) {
                // Clear existing options
                assignedUserDropdown.innerHTML = '';

                // Example options
                const assignedUsers = [
                    { value: 'agent1', label: 'Teddy Ndebele' },
                    { value: 'agent2', label: 'Shahz Sheikh' },
                    { value: 'agent3', label: 'Agent 3' }
                ];

                // Populate dropdown with options
                assignedUsers.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.value;
                    option.textContent = user.label;
                    assignedUserDropdown.appendChild(option);
                });

                // Set the selected value based on the "assignedUser" from data
                assignedUserDropdown.value = selectedUser || '';
            } else {
                console.error('Assigned User dropdown element not found');
            }
        }

        // edit PropertyListings
        function editPropertyListings(id) {
            db.collection('propertyListings').doc(id).get().then((doc) => {
                if (doc.exists) {
                    const data = doc.data();
                    console.log('Firebase Response Data (JSON):', JSON.stringify(data, null, 2));
                    document.getElementById('editPropertyId').value = doc.id;
                    // Type Section
                    const propertyTypeElement = document.querySelector(`input[name="editPropertyType"][value="${data.propertyType}"]`);
                    if (propertyTypeElement) propertyTypeElement.checked = true;

                    const transactionTypeElement = document.querySelector(`input[name="editTransactionType"][value="${data.offeringType === 'RS' || data.offeringType === 'CS' ? 'Sale' : 'Rent'}"]`);
                    if (transactionTypeElement) transactionTypeElement.checked = true;

                    // Populate dropdowns using the provided dropdownData
                    populateDropdown('editProperty_Bedrooms', dropdownData.bedrooms.map(item => ({ id: item.value, name: item.label })));
                    populateDropdown('editProperty_Bathrooms', dropdownData.bathrooms.map(item => ({ id: item.value, name: item.label })));
                    populateDropdown('editProperty_FurnishingType', dropdownData.furnishingType.map(item => ({ id: item.value, name: item.label })));
                    populateDropdown('editPropertyType', dropdownData.propertyType.map(item => ({ id: item.value, name: item.label })));
                    populateDropdown('propertyStatus', dropdownData.propertyStatus.map(item => ({ id: item.value, name: item.label })));

                    // Specifications Section
                    document.getElementById('editProperty_Size').value = data.size || '';
                    document.getElementById('editProperty_Bedrooms').value = data.bedrooms || '';
                    document.getElementById('editProperty_Bathrooms').value = data.bathrooms || '';
                    document.getElementById('editProperty_FurnishingType').value = data.furnished || '';
                    document.getElementById('editProperty_ParkingSpaces').value = data.parking || '';
                    document.getElementById('editProperty_PlotSize').value = data.plotSize || '';
                    document.getElementById('editProperty_BuiltUpArea').value = data.builtUpArea || '';

                    // Property Permit Section
                    const permitType = data.permit?.type || '';

                    if (permitType === 'RERA') {
                        document.getElementById('editRera').checked = true;
                        togglePermitFieldsEdit(); // Ensure RERA fields are shown
                        document.getElementById('editReraListingNo').value = data.permit?.reraListingNo || '';
                    } else if (permitType === 'DTCM') {
                        document.getElementById('editDtcm').checked = true;
                        togglePermitFieldsEdit(); // Ensure DTCM fields are shown
                        document.getElementById('editDtcmPermitNo').value = data.permit?.dtcmPermitNo || '';
                    }

                    document.getElementById('editPermitFromDate').value = data.permit?.permitFromDate || '';
                    document.getElementById('editPermitToDate').value = data.permit?.permitToDate || '';

                    // Call the toggle function to ensure the correct fields are shown based on the selected permit type
                    togglePermitFieldsEdit();
                    // Pricing Section (for Sale)
                    document.getElementById('editSalePrice').value = data.pricing?.salePrice || '';

                    // Description Section
                    document.getElementById('editEnglishTitle').value = data.title || '';
                    document.getElementById('editEnglishDescription').value = data.description || '';

                    // Amenities Section
                    const selectedAmenities = document.getElementById('editSelectedAmenities');
                    if (selectedAmenities) {
                        selectedAmenities.innerHTML = '';
                        if (data.amenities && data.amenities.length > 0) {
                            data.amenities.forEach(amenity => {
                                const newAmenity = document.createElement('span');
                                newAmenity.className = 'badge bg-primary m-1';
                                newAmenity.textContent = amenity;
                                selectedAmenities.appendChild(newAmenity);
                            });
                        }
                    }

                    // Management Section
                    const referenceElement = document.getElementById('editReference');
                    if (referenceElement) {
                        referenceElement.value = data.management?.agentLicenseNo || '';  // Assuming reference is the agent license number
                    }

                    // Populate the Assigned User dropdown and select the correct user
                    populateAssignedUsersDropdown(data.management?.assignedUser);

                    // Populate the Owner dropdown and select the correct owner
                    populateOwnersDropdown(data.management?.owner);
                    // Location Section
                    const lat = data.location?.geoPoint?.lat || 25.276987; // Default to Dubai lat if missing
                    const lng = data.location?.geoPoint?.lng || 55.296249; // Default to Dubai lng if missing

                    // Initialize the map with lat/lng from Firebase and set the correct input fields
                    initMap(lat, lng, "editLocationSearch", "editMap", "editGeoLat", "editGeoLng");

                    // Populate other fields (Community, Unit No, etc.)
                    document.getElementById('editLocationSearch').value = data.location?.community || '';
                    document.getElementById('editUnitNumber').value = data.location?.unitNo || 'N/A';
                    document.getElementById('editGeoLat').value = lat;
                    document.getElementById('editGeoLng').value = lng;
                    // Initialize map with lat/lng coordinates
                    if (data.location?.geoPoint) {
                        const lat = data.location.geoPoint.lat;
                        const lng = data.location.geoPoint.lng;
                        if (lat && lng) {
                            // Initialize or update the map with the given lat/lng values
                            initMap(lat, lng);  // Ensure `initMap` is defined elsewhere in your script
                        } else {
                            console.error('Latitude or Longitude missing.');
                        }
                    } else {
                        console.error('GeoPoint data missing.');
                    }
                    // Media Section
                    const imageThumbnails = document.getElementById('editImageThumbnails');
                    if (imageThumbnails && data.media?.images) {
                        imageThumbnails.innerHTML = '';
                        data.media.images.forEach(imageUrl => {
                            const imgElement = document.createElement('img');
                            imgElement.src = imageUrl;
                            imgElement.className = 'img-thumbnail m-2';
                            imgElement.style.width = '100px';
                            imageThumbnails.appendChild(imgElement);
                        });
                    }

                    document.getElementById('editTour360Url').value = data.media?.tour360 || '';
                    document.getElementById('editVideoTourUrl').value = data.media?.videoTour || '';

                    // Floor Plan Section
                    const floorPlanThumbnails = document.getElementById('editFloorPlanThumbnails');
                    if (floorPlanThumbnails && data.media?.floorPlans) {
                        floorPlanThumbnails.innerHTML = '';
                        data.media.floorPlans.forEach(floorPlanUrl => {
                            const fileLink = document.createElement('a');
                            fileLink.href = floorPlanUrl;
                            fileLink.textContent = 'View Floor Plan';
                            fileLink.target = '_blank';
                            floorPlanThumbnails.appendChild(fileLink);
                        });
                    }
                    // Load availability
                    const availability = data.availability || '';
                    const availableOption = document.getElementById('editAvailable');
                    const underOfferOption = document.getElementById('editUnderOffer');
                    const reservedOption = document.getElementById('editReserved');
                    const rentedOption = document.getElementById('editRented');

                    // Clear all radio buttons first
                    availableOption.checked = false;
                    underOfferOption.checked = false;
                    reservedOption.checked = false;
                    rentedOption.checked = false;

                    // Check the corresponding radio button based on the availability value from Firebase
                    switch (availability.toLowerCase()) {
                        case 'available':
                            availableOption.checked = true;
                            break;
                        case 'under offer':
                            underOfferOption.checked = true;
                            break;
                        case 'reserved':
                            reservedOption.checked = true;
                            break;
                        case 'rented':
                            rentedOption.checked = true;
                            break;
                        default:
                            console.error('Unknown availability status:', availability);
                    }

                    // Exclusivity Section
                    const exclusivityStatus = data.exclusivity?.status || false;
                    const exclusivityCheckbox = document.getElementById('editExclusivity');
                    const startDateField = document.getElementById('editStartDate');
                    const expiryDateField = document.getElementById('editExpiryDate');
                    const exclusivityDatesSection = document.getElementById('editExclusivityDates');

                    exclusivityCheckbox.checked = exclusivityStatus;

                    // Show/hide start and expiry dates based on exclusivity status
                    if (exclusivityStatus) {
                        exclusivityDatesSection.style.display = 'block';
                        startDateField.value = data.exclusivity?.startDate || '';
                        expiryDateField.value = data.exclusivity?.expiryDate || '';
                    } else {
                        exclusivityDatesSection.style.display = 'none';
                        startDateField.value = '';
                        expiryDateField.value = '';
                    }

                    // Date picker for "Available From"
                    document.getElementById('editAvailableFrom').value = data.availabilityFrom || '';

                    // Document Section
                    const documentThumbnails = document.getElementById('editDocumentThumbnails');
                    documentThumbnails.innerHTML = ''; // Clear any existing thumbnails

                    if (data.media?.documents && data.media.documents.length > 0) {
                        data.media.documents.forEach((docUrl) => {
                            // Create a thumbnail or link for each document
                            const documentElement = document.createElement('a');
                            documentElement.href = docUrl;
                            documentElement.target = '_blank'; // Open in new tab
                            documentElement.textContent = docUrl.split('/').pop(); // Use the filename from the URL
                            documentElement.className = 'btn btn-outline-secondary m-1'; // Style as button or link

                            // Append the document link to the thumbnails container
                            documentThumbnails.appendChild(documentElement);
                        });
                    } else {
                        // If no documents exist, you can display a message
                        const noDocumentsMessage = document.createElement('p');
                        noDocumentsMessage.textContent = 'No documents uploaded.';
                        documentThumbnails.appendChild(noDocumentsMessage);
                    }

                    // Pricing Section
                    // Always show the sale pricing section
                    togglePricingSectionEdit();

                    // Populate the Sale pricing fields
                    document.getElementById('editSalePrice').value = data.pricing?.salePrice || '';


                    // Show the modal
                    const editPropertyModal = new bootstrap.Modal(document.getElementById('editPropertyModal'));
                    editPropertyModal.show();
                } else {
                    alert('No such property!');
                }
            }).catch(error => {
                console.error('Error loading property:', error);
                alert('Failed to load property. Please try again.');
            });
        }






        // Handle form submission
        document.getElementById('propertyListingForm').addEventListener('submit', function (event) {
            event.preventDefault();

            // Title (Title Deeds saved as title) and Property Type
            const title = getDummyValue(document.getElementById('titleDeeds').value, 'Default Property Name'); // Save Title Deeds as title
            const propertyType = document.querySelector('input[name="propertyType"]:checked').value; // Get selected property type (Residential/Commercial)

            // Transaction Type (Rent/Sale)
            const transactionType = document.querySelector('input[name="transactionType"]:checked').value; // Get selected transaction type (Rent/Sale)

            // Determine offeringType based on propertyType and transactionType
            let offeringType;
            if (propertyType === 'Residential') {
                offeringType = transactionType === 'Sale' ? 'RS' : 'RR'; // RS for Residential Sale, RR for Residential Rent
            } else if (propertyType === 'Commercial') {
                offeringType = transactionType === 'Sale' ? 'CS' : 'CR'; // CS for Commercial Sale, CR for Commercial Rent
            }

            // Property Status (Completion Status) and Off-plan Logic
            let completionStatus = null;
            let offplan = true;
            // Handling Pricing Based on Offering Type
            let pricing = { price: null }; // Default pricing object

            if (transactionType === 'Rent') {
                // Collecting rent-specific pricing values
                pricing = {
                    yearlyPrice: parseInt(document.getElementById('price_per_year').value, 10) || 0,
                    monthlyPrice: parseInt(document.getElementById('price_per_month').value, 10) || 0,
                    weeklyPrice: parseInt(document.getElementById('price_per_week').value, 10) || 0,
                    dailyPrice: parseInt(document.getElementById('price_per_day').value, 10) || 0,
                    cheques: parseInt(document.getElementById('cheques').value, 10) || 1,
                    financialStatus: document.getElementById('financial_status').value || 'Cash',
                    serviceCharges: parseInt(document.getElementById('service_charges').value, 10) || 0,
                    // rentalPeriod: document.getElementById('rentalPeriod').value || 'Y',
                    // priceOnApplication: document.getElementById('priceOnApplication').value || 'No'
                };

                // Determining which price (yearly, monthly, weekly, daily) is selected as default
                const selectedPrice = document.querySelector('input[name="default_price"]:checked').value;

                switch (selectedPrice) {
                    case 'year':
                        pricing.price = pricing.yearlyPrice;
                        break;
                    case 'month':
                        pricing.price = pricing.monthlyPrice;
                        break;
                    case 'week':
                        pricing.price = pricing.weeklyPrice;
                        break;
                    case 'day':
                        pricing.price = pricing.dailyPrice;
                        break;
                    default:
                        pricing.price = pricing.yearlyPrice; // Fallback to yearly price if no option is selected
                        break;
                }
            } else if (transactionType === 'Sale') {
                // Collecting sale-specific pricing values
                pricing = {
                    salePrice: parseInt(document.getElementById('sale_price').value, 10) || 0,
                    price: parseInt(document.getElementById('sale_price').value, 10) || 0 // Setting price to salePrice
                };
            }

            // After this, pricing object is ready with correct fields


            // Other Fields
            const size = getDummyValue(parseInt(document.getElementById('size').value, 10), 1000);
            const bedrooms = getDummyValue(parseInt(document.getElementById('bedrooms').value, 10), 2);
            const bathrooms = getDummyValue(parseInt(document.getElementById('bathrooms').value, 10), 2);
            const furnished = getDummyValue(document.getElementById('furnishingType').value, 'Unfurnished'); // Save furnishingType as furnished
            const parking = getDummyValue(document.getElementById('parkingSpaces').value.toString(), '1'); // Save as string
            const plotSize = getDummyValue(parseInt(document.getElementById('plotSize').value, 10), 1500);
            const builtUpArea = getDummyValue(parseInt(document.getElementById('builtUpArea').value, 10), 1200);
            const description = getDummyValue(document.getElementById('englishDescription').value, 'No description provided');
            const amenities = getDummyValue(Array.from(document.getElementById('selected-amenities').children).map(child => child.textContent.trim()), ['Basic Amenities']);
            const availability = getDummyValue(document.querySelector('input[name="availability"]:checked').value, 'Available');

            // Exclusivity Fields
            const exclusivity = {
                status: getDummyValue(document.getElementById('exclusivity').checked, false),
                startDate: getDummyValue(document.getElementById('startDate').value, null),
                expiryDate: getDummyValue(document.getElementById('expiryDate').value, null)
            };

            // Permit Fields
            const permit = {
                type: getDummyValue(document.querySelector('input[name="permitType"]:checked').value, 'RERA'),
                reraListingNo: getDummyValue(document.getElementById('reraListingNo').value, 'N/A'),
                dtcmPermitNo: getDummyValue(document.getElementById('dtcmPermitNo').value, 'N/A'),
                permitFromDate: getDummyValue(document.getElementById('permitFromDate').value, null),
                permitToDate: getDummyValue(document.getElementById('permitToDate').value, null)
            };

            // Management Fields
            const management = {
                assignedUser: getDummyValue(document.getElementById('assignedUser').value, 'Admin'),
                owner: getDummyValue(document.getElementById('owner').value, 'Company'),
                agentLicenseNo: '00000', // Dummy data
                agentPhoto: 'https://example.com/agent-photo.png', // Dummy data
                agentPhone: '+97100000000' // Dummy data
            };

            // Location Fields (Splitting address into community and subCommunity)
            const address = getDummyValue(document.getElementById('locationSearch').value, 'Dubai');
            const [community, subCommunity] = address.split(', ').slice(-2); // Extract last two components of the address

            const location = {
                community: community || 'Unknown Community',
                subCommunity: subCommunity || 'Unknown Sub-community',
                unitNo: getDummyValue(document.getElementById('unitNumber').value, 'Unit 1'),
                geoPoint: {
                    lat: getDummyValue(parseFloat(document.getElementById('geoLat').value), 25.276987),
                    lng: getDummyValue(parseFloat(document.getElementById('geoLng').value), 55.296249)
                }
            };

            // Media Fields including FloorPlans and Documents
            const media = {
                images: (document.getElementById('propertyImages').dataset.urls || '').split(',').filter(url => url) || ['dummy-image-url'],
                videoTour: getDummyValue(document.getElementById('videoTourUrl').value, null),
                tour360: getDummyValue(document.getElementById('tour360Url').value, null),
                floorPlans: (document.getElementById('floorPlanDocuments').dataset.urls || '').split(',').filter(url => url) || ['dummy-floorplan-url'],
                documents: (document.getElementById('propertyDocuments').dataset.urls || '').split(',').filter(url => url) || ['dummy-document-url']
            };

            // Final Property Data Object
            const propertyData = {
                title,  // Title Deeds saved as title
                propertyType,  // Save the property type selected in the dropdown
                offeringType,  // Save the determined offeringType (RS, RR, CS, CR)
                completionStatus,  // Save propertyStatus as completionStatus
                offplan,  // Boolean value based on property status
                pricing,
                size,
                bedrooms,
                bathrooms,
                furnished,  // Save furnishingType as furnished
                parking,  // Save as string
                plotSize,
                builtUpArea,
                description,
                amenities,
                availability,
                exclusivity,
                permit,
                management,
                location,
                media,
                creationDate: new Date().toISOString(),
                lastUpdateDate: new Date().toISOString(),
                createdBy: 'Admin User'
            };

            // Save or update based on propertyId
            const propertyId = document.getElementById('property-id').value;

            if (propertyId) {
                // Update property
                db.collection('propertyListings').doc(propertyId).update(propertyData).then(() => {
                    alert('Property updated successfully!');
                }).catch(error => {
                    console.error('Error updating property:', error);
                    alert('Failed to update property. Please try again.');
                });
            } else {
                // Add new property
                db.collection('propertyListings').add(propertyData).then(() => {
                    alert('Property added successfully!');
                }).catch(error => {
                    console.error('Error adding property:', error);
                    alert('Failed to add property. Please try again.');
                });
            }
        });
        function getDummyValue(value, dummy) {
            return value ? value : dummy;
        }


        /* Toggle pricing sections
        function togglePricingSection() {
            const rentPricingSection = document.getElementById('rentPricingSection');
            const salePricingSection = document.getElementById('salePricingSection');
            const salePriceInput = document.getElementById('sale_price');

            const transactionType = document.querySelector('input[name="transactionType"]:checked').value;

            if (transactionType === 'Rent') {
                rentPricingSection.style.display = 'block';
                salePricingSection.style.display = 'none';
                salePriceInput.removeAttribute('required');
            } else if (transactionType === 'Sale') {
                rentPricingSection.style.display = 'none';
                salePricingSection.style.display = 'block';
                salePriceInput.setAttribute('required', 'required');
            }
        }*/
        function togglePricingSection() {
            const rentPricingSection = document.getElementById('rentPricingSection');
            const salePricingSection = document.getElementById('salePricingSection');
            const salePriceInput = document.getElementById('sale_price');

            // Always show Sale pricing section and ensure Sale price is required
            rentPricingSection.style.display = 'none';  // Hide Rent pricing section
            salePricingSection.style.display = 'block'; // Show Sale pricing section
            salePriceInput.setAttribute('required', 'required'); // Make Sale price required
        }
        // Always show the sale pricing section for Edit
        function togglePricingSectionEdit() {
            const rentPricingSection = document.getElementById('editRentPricingSection');
            const salePricingSection = document.getElementById('editSalePricingSection');
            const salePriceInput = document.getElementById('editSalePrice');

            // Hide Rent pricing section and show Sale pricing section
            rentPricingSection.style.display = 'none';
            salePricingSection.style.display = 'block';

            // Ensure Sale price is required
            salePriceInput.setAttribute('required', 'required');
        }



        function togglePermitFields() {
            const reraField = document.getElementById('reraListingNoField');
            const dtcmFields = document.getElementById('dtcmFields');

            if (document.getElementById('rera').checked) {
                reraField.style.display = 'block';
                dtcmFields.style.display = 'none';
            } else if (document.getElementById('dtcm').checked) {
                reraField.style.display = 'none';
                dtcmFields.style.display = 'block';
            } else {
                reraField.style.display = 'none';
                dtcmFields.style.display = 'none';
            }
        }
        function togglePermitFieldsEdit() {
            const reraField = document.getElementById('editReraListingNoField'); // Edit RERA Listing No field
            const dtcmFields = document.getElementById('editDtcmFields'); // Edit DTCM fields

            // Check if the RERA or DTCM radio button is selected
            if (document.getElementById('editRera').checked) {
                // Show RERA fields and hide DTCM fields
                reraField.style.display = 'block';
                dtcmFields.style.display = 'none';
            } else if (document.getElementById('editDtcm').checked) {
                // Show DTCM fields and hide RERA fields
                reraField.style.display = 'none';
                dtcmFields.style.display = 'block';
            } else {
                // Hide both RERA and DTCM fields if none are selected
                reraField.style.display = 'none';
                dtcmFields.style.display = 'none';
            }
        }


        document.addEventListener('DOMContentLoaded', function () {
            togglePermitFields();
            document.getElementById('rera').addEventListener('click', togglePermitFields);
            document.getElementById('dtcm').addEventListener('click', togglePermitFields);
        });

        const amenities = [
            "BALCONY", "CABLE-READY", "CENTRAL AIR CONDITIONING", "CONFERENCE ROOM", "COVERED PARKING",
            "LOBBY IN BUILDING", "PANTRY", "PRIVATE GARDEN", "PRIVATE POOL", "SEA/WATER VIEW", "SECURITY",
            "SHARED GYM", "SHARED SWIMMING POOL", "VASTU-COMPLIANT", "BASEMENT PARKING", "CHILDREN DAYCARE",
            "CITY VIEW", "CLEANING SERVICES", "CORE AND SHELL", "EAST ORIENTATION", "GARDEN VIEW", "GROUND FLOOR",
            "HEATING", "MAINTENANCE", "NEAR HOTEL", "NEAR METRO", "NEAR MOSQUE", "NEAR PUBLIC TRANSPORTATION",
            "NEAR RESTAURANTS", "NEAR SUPERMARKET", "NORTH ORIENTATION", "OFFICE PARTITIONS", "ON HIGH FLOOR",
            "ON LOW FLOOR", "ON MID FLOOR", "RECEPTION AREA", "SERVER ROOM", "SOUTH ORIENTATION", "STORAGE ROOM",
            "VISITORS PARKING", "WEST ORIENTATION"
        ];

        const amenitiesList = document.getElementById('amenities-list');
        amenities.forEach(amenity => {
            const button = document.createElement('button');
            button.className = 'btn btn-outline-primary m-1';
            button.textContent = amenity;
            button.onclick = function () { toggleAmenity(this) };
            amenitiesList.appendChild(button);
        });

        function toggleAmenity(element) {
            const amenity = element.textContent.trim();
            const selectedAmenities = document.getElementById('selected-amenities');

            if (element.classList.contains('btn-primary')) {
                element.classList.remove('btn-primary');
                element.classList.add('btn-outline-primary');

                const removeAmenity = Array.from(selectedAmenities.children).find(child => child.textContent.trim() === amenity);
                if (removeAmenity) selectedAmenities.removeChild(removeAmenity);
            } else {
                element.classList.remove('btn-outline-primary');
                element.classList.add('btn-primary');

                const newAmenity = document.createElement('div');
                newAmenity.className = 'badge bg-primary m-1';
                newAmenity.textContent = amenity;
                selectedAmenities.appendChild(newAmenity);
            }
        }

        function toggleLanguage() {
            const isArabic = document.getElementById("languageToggle").checked;
            document.getElementById("englishContent").style.display = isArabic ? "none" : "block";
            document.getElementById("arabicContent").style.display = isArabic ? "block" : "none";
        }
        function initMap(lat = 25.276987, lng = 55.296249, inputFieldId = "locationSearch", mapElementId = "map", geoLatId = "geoLat", geoLngId = "geoLng") {
            const location = { lat: lat, lng: lng };  // Use provided lat/lng or default to Dubai
            const map = new google.maps.Map(document.getElementById(mapElementId), {
                zoom: 10,
                center: location,
            });

            // Initialize the marker
            const marker = new google.maps.Marker({
                position: location,
                map: map,
                draggable: true, // Make marker draggable for manual updates
            });

            // Autocomplete functionality for location search input
            const input = document.getElementById(inputFieldId);
            const autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo('bounds', map);

            // Update map and marker when a place is selected
            autocomplete.addListener('place_changed', () => {
                const place = autocomplete.getPlace();
                if (!place.geometry || !place.geometry.location) {
                    window.alert("No details available for input: '" + place.name + "'");
                    return;
                }
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(17);
                }
                marker.setPosition(place.geometry.location);
                document.getElementById(geoLatId).value = place.geometry.location.lat();
                document.getElementById(geoLngId).value = place.geometry.location.lng();
            });

            // Update lat/lng inputs when the marker is dragged
            marker.addListener('dragend', () => {
                const position = marker.getPosition();
                document.getElementById(geoLatId).value = position.lat();
                document.getElementById(geoLngId).value = position.lng();
                map.setCenter(position);
            });

            // Optional: Re-center the map when the lat/lng fields are manually updated
            document.getElementById(geoLatId).addEventListener('change', () => {
                updateMapFromCoordinates();
            });

            document.getElementById(geoLngId).addEventListener('change', () => {
                updateMapFromCoordinates();
            });

            // Function to update the map and marker from manual lat/lng input
            function updateMapFromCoordinates() {
                const lat = parseFloat(document.getElementById(geoLatId).value);
                const lng = parseFloat(document.getElementById(geoLngId).value);

                if (!isNaN(lat) && !isNaN(lng)) {
                    const newPosition = { lat: lat, lng: lng };
                    map.setCenter(newPosition);
                    marker.setPosition(newPosition);
                } else {
                    window.alert("Please enter valid latitude and longitude values.");
                }
            }
        }

        function loadGoogleMaps() {
            const script = document.createElement("script");
            script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyCvfYNuZy5x4nYFZI0t3rCY6ePdU2ss9nk&libraries=places&callback=initMap`;
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
        }

        document.addEventListener('DOMContentLoaded', loadGoogleMaps);

        document.addEventListener('DOMContentLoaded', function () {
            populateDropdown('assignedUser', agents);
            populateDropdown('owner', owners);

            if (typeof $.fn.select2 === 'function') {
                $('#assignedUser').select2({
                    placeholder: 'Select Assigned User',
                    allowClear: true
                });

                $('#owner').select2({
                    placeholder: 'Select Owner',
                    allowClear: true
                });
            } else {
                console.error("Select2 is not loaded. Please check if the Select2 library is included correctly.");
            }
        });

        const agents = [
            { id: 'agent1', name: 'Teddy Ndebele' },
            { id: 'agent2', name: 'Shahz Sheikh' }
        ];

        const owners = [
            { id: 'owner1', name: 'William Lee' },
            { id: 'owner2', name: 'Elizabeth Harris' },
            { id: 'owner3', name: 'Charles Clark' },
            { id: 'owner4', name: 'Jessica Lewis' },
            { id: 'owner5', name: 'Christopher Walker' },
            { id: 'owner6', name: 'Amanda Young' },
            { id: 'owner7', name: 'George Martinez' },
            { id: 'owner8', name: 'Mary Robinson' },
            { id: 'owner9', name: 'Thomas Hall' },
            { id: 'owner10', name: 'Barbara Allen' }
        ];

        function populateDropdown(dropdownId, data) {
            const dropdown = document.getElementById(dropdownId);
            if (!dropdown) {
                console.error(`Dropdown with ID ${dropdownId} not found.`);
                return;
            }

            // Clear the existing options before appending new ones
            dropdown.innerHTML = '';

            data.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = item.name;
                dropdown.appendChild(option);
            });
        }

        function handleImageUpload(input) {
            const imageThumbnails = document.getElementById('imageThumbnails');
            imageThumbnails.innerHTML = '';
            let imageUrls = [];

            const fileArray = Array.from(input.files);
            fileArray.forEach(file => {
                const storageRef = storage.ref(`properties/images/${file.name}`);
                const uploadTask = storageRef.put(file);

                uploadTask.on('state_changed', null, (error) => {
                    console.error('Error uploading image:', error);
                }, () => {
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        imageUrls.push(downloadURL); // Add to array

                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'thumbnail';
                        thumbnail.style.margin = '10px';
                        thumbnail.style.position = 'relative';

                        const img = document.createElement('img');
                        img.src = downloadURL;
                        img.style.width = '100px';
                        img.style.height = '100px';
                        img.style.objectFit = 'cover';
                        img.style.borderRadius = '5px';

                        const removeButton = document.createElement('button');
                        removeButton.className = 'btn btn-danger btn-sm';
                        removeButton.style.position = 'absolute';
                        removeButton.style.top = '5px';
                        removeButton.style.right = '5px';
                        removeButton.innerHTML = '&times;';
                        removeButton.onclick = function () {
                            thumbnail.remove();
                            imageUrls = imageUrls.filter(url => url !== downloadURL); // Remove URL from array
                            updateImageUrls(imageUrls);
                        };

                        thumbnail.appendChild(img);
                        thumbnail.appendChild(removeButton);
                        imageThumbnails.appendChild(thumbnail);

                        updateImageUrls(imageUrls); // Update the dataset after each upload
                    });
                });
            });
        }

        function handleFloorPlanUpload(input) {
            const floorPlanThumbnails = document.getElementById('editRentSaleFloorPlanThumbnails');
            floorPlanThumbnails.innerHTML = ''; // Clear existing thumbnails
            let floorPlans = []; // Array to store objects with URLs and names

            const fileArray = Array.from(input.files);
            fileArray.forEach(file => {
                const storageRef = storage.ref(`properties/floorPlans/${file.name}`);
                const uploadTask = storageRef.put(file);

                uploadTask.on('state_changed', null, (error) => {
                    console.error('Error uploading floor plan:', error);
                }, () => {
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        const floorPlanObject = { url: downloadURL, name: '' }; // Initialize with empty name
                        floorPlans.push(floorPlanObject); // Add object to array

                        // Create file item container
                        const fileItem = document.createElement('div');
                        fileItem.className = 'file-item';
                        fileItem.style.margin = '10px';
                        fileItem.style.position = 'relative';
                        fileItem.style.display = 'flex';
                        fileItem.style.alignItems = 'center';

                        // Create label for the file name
                        const fileNameLabel = document.createElement('span');
                        fileNameLabel.textContent = file.name;
                        fileNameLabel.style.marginRight = '10px';

                        // Create input for floor plan name
                        const floorPlanNameInput = document.createElement('input');
                        floorPlanNameInput.className = 'form-control';
                        floorPlanNameInput.placeholder = 'Enter floor plan name';
                        floorPlanNameInput.style.width = '70%';

                        // Update name in the array when the user types
                        floorPlanNameInput.addEventListener('input', function () {
                            floorPlanObject.name = floorPlanNameInput.value;
                        });

                        // Create remove button
                        const removeButton = document.createElement('button');
                        removeButton.className = 'btn btn-danger btn-sm';
                        removeButton.style.marginLeft = '10px';
                        removeButton.innerHTML = '&times;';
                        removeButton.onclick = function () {
                            fileItem.remove();
                            floorPlans = floorPlans.filter(plan => plan.url !== downloadURL); // Remove the object
                            updateFloorPlanData(floorPlans);
                        };

                        // Append elements to the file item container
                        fileItem.appendChild(fileNameLabel);
                        fileItem.appendChild(floorPlanNameInput);
                        fileItem.appendChild(removeButton);

                        // Append the file item to the thumbnails container
                        floorPlanThumbnails.appendChild(fileItem);

                        // Update the floor plan data
                        updateFloorPlanData(floorPlans); // Update the dataset
                    });
                });
            });
        }

        function updateFloorPlanData(floorPlans) {
            // Function to handle the collected data (URLs and names)
            console.log('Updated floor plans:', floorPlans);
            // Send this data to your backend or handle it as necessary
        }



        function handleDocumentUpload(input) {
            const documentThumbnails = document.getElementById('documentThumbnails');
            documentThumbnails.innerHTML = '';
            let documentUrls = [];

            const fileArray = Array.from(input.files);
            fileArray.forEach(file => {
                const storageRef = storage.ref(`properties/documents/${file.name}`);
                const uploadTask = storageRef.put(file);

                uploadTask.on('state_changed', null, (error) => {
                    console.error('Error uploading document:', error);
                }, () => {
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        documentUrls.push(downloadURL); // Add to array

                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'thumbnail';
                        thumbnail.style.margin = '10px';
                        thumbnail.style.position = 'relative';

                        const icon = document.createElement('div');
                        icon.innerHTML = '<i class="fas fa-file-alt"></i>';
                        icon.style.fontSize = '50px';
                        icon.style.marginBottom = '5px';

                        const fileName = document.createElement('p');
                        fileName.textContent = file.name;
                        fileName.style.fontSize = '12px';
                        fileName.style.textAlign = 'center';

                        const removeButton = document.createElement('button');
                        removeButton.className = 'btn btn-danger btn-sm';
                        removeButton.style.position = 'absolute';
                        removeButton.style.top = '5px';
                        removeButton.style.right = '5px';
                        removeButton.innerHTML = '&times;';
                        removeButton.onclick = function () {
                            thumbnail.remove();
                            documentUrls = documentUrls.filter(url => url !== downloadURL); // Remove URL
                            updateDocumentUrls(documentUrls);
                        };

                        thumbnail.appendChild(icon);
                        thumbnail.appendChild(fileName);
                        thumbnail.appendChild(removeButton);
                        documentThumbnails.appendChild(thumbnail);

                        updateDocumentUrls(documentUrls); // Update the dataset
                    });
                });
            });
        }

        // Helper functions to update the dataset attributes
        function updateImageUrls(imageUrls) {
            document.getElementById('propertyImages').dataset.urls = imageUrls.join(',');
        }

        function updateFloorPlanUrls(floorPlanUrls) {
            document.getElementById('floorPlanDocuments').dataset.urls = floorPlanUrls.join(',');
        }

        function updateDocumentUrls(documentUrls) {
            document.getElementById('propertyDocuments').dataset.urls = documentUrls.join(',');
        }


        // Update submission
        document.addEventListener('DOMContentLoaded', function () {
            const saveButton = document.getElementById('saveEditedPropertyListing');
            if (saveButton) {

                saveButton.addEventListener('click', function (event) {
                    event.preventDefault();

                    // Collect the ID of the property being edited
                    const id = document.getElementById('editPropertyId').value;
                    const transactionType = document.querySelector('input[name="editTransactionType"]:checked').value;

                    // Collect updated property data from the form fields
                    const updatedData = {
                        title: document.getElementById('editEnglishTitle').value || '',
                        propertyType: document.querySelector('input[name="editPropertyType"]:checked').value || '',
                        transactionType: transactionType || '',
                        size: parseInt(document.getElementById('editProperty_Size').value, 10) || 0,
                        bedrooms: parseInt(document.getElementById('editProperty_Bedrooms').value, 10) || 0,
                        bathrooms: parseInt(document.getElementById('editProperty_Bathrooms').value, 10) || 0,
                        furnishingType: document.getElementById('editProperty_FurnishingType').value || '',
                        parkingSpaces: parseInt(document.getElementById('editProperty_ParkingSpaces').value, 10) || 0,
                        plotSize: parseInt(document.getElementById('editProperty_PlotSize').value, 10) || 0,
                        builtUpArea: parseInt(document.getElementById('editProperty_BuiltUpArea').value, 10) || 0,
                        description: document.getElementById('editEnglishDescription').value || '',
                        amenities: Array.from(document.getElementById('editSelectedAmenities').children).map(child => child.textContent.trim()),

                        // Availability
                        availability: document.querySelector('input[name="editAvailability"]:checked').value || '',
                        availabilityFrom: document.getElementById('editAvailableFrom').value || '',

                        // Exclusivity
                        exclusivity: {
                            status: document.getElementById('editExclusivity').checked,
                            startDate: document.getElementById('editStartDate').value || '',
                            expiryDate: document.getElementById('editExpiryDate').value || ''
                        },

                        // Permit Information
                        permit: {
                            type: document.querySelector('input[name="editPermitType"]:checked').value || '',
                            reraListingNo: document.getElementById('editReraListingNo').value || '',
                            dtcmPermitNo: document.getElementById('editDtcmPermitNo').value || '',
                            permitFromDate: document.getElementById('editPermitFromDate').value || '',
                            permitToDate: document.getElementById('editPermitToDate').value || ''
                        },

                        // Management Information
                        management: {
                            assignedUser: document.getElementById('editAssignedUser').value || '',
                            owner: document.getElementById('editOwner').value || ''
                        },

                        // Location Information
                        location: {
                            address: document.getElementById('editLocationSearch').value || '',
                            unitNo: document.getElementById('editUnitNumber').value || 'N/A',
                            geoPoint: {
                                lat: parseFloat(document.getElementById('editGeoLat').value) || 0,
                                lng: parseFloat(document.getElementById('editGeoLng').value) || 0
                            }
                        },

                        // Media Information
                        media: {
                            tour360: document.getElementById('editTour360Url').value || '',
                            videoTour: document.getElementById('editVideoTourUrl').value || '',
                            documents: [], // Add logic to handle uploaded documents
                            images: [] // Add logic to handle uploaded images
                        }
                    };

                    // Handling pricing for Rent and Sale
                    if (transactionType === 'Rent') {
                        updatedData.pricing = {
                            yearlyPrice: parseInt(document.getElementById('editPricePerYear').value, 10) || 0,
                            monthlyPrice: parseInt(document.getElementById('editPricePerMonth').value, 10) || 0,
                            weeklyPrice: parseInt(document.getElementById('editPricePerWeek').value, 10) || 0,
                            dailyPrice: parseInt(document.getElementById('editPricePerDay').value, 10) || 0,
                            defaultPrice: document.querySelector('input[name="editDefaultPrice"]:checked').value || '',
                            cheques: parseInt(document.getElementById('editCheques').value, 10) || 1,
                            financialStatus: document.getElementById('editFinancialStatus').value || '',
                            serviceCharges: parseInt(document.getElementById('editServiceCharges').value, 10) || 0
                        };
                    } else if (transactionType === 'Sale') {
                        updatedData.pricing = {
                            salePrice: parseInt(document.getElementById('editSalePrice').value, 10) || 0
                        };
                    }

                    console.log("Updated Data:", updatedData); // Debugging log

                    // Update the Firestore document
                    db.collection('propertyListings').doc(id).update(updatedData)
                        .then(() => {
                            console.log('Property updated successfully!'); // Log on successful update
                            alert('Property updated successfully!');
                            const editPropertyModal = bootstrap.Modal.getInstance(document.getElementById('editPropertyModal'));
                            editPropertyModal.hide(); // Hide the modal after a successful update
                            loadPropertyListings(); // Reload the property listings to reflect changes
                        })
                        .catch(error => {
                            console.error('Error updating property:', error);
                            alert('Failed to update property. Please try again.');
                        });
                });
            }
        });




        const amenitiesMapping = {
            "BA": "Balcony",
            "BP": "Basement parking",
            "BB": "BBQ area",
            "AN": "Cable-ready",
            "BW": "Built in wardrobes",
            "CA": "Carpets",
            "AC": "Central air conditioning",
            "CP": "Covered parking",
            "DR": "Drivers room",
            "FF": "Fully fitted kitchen",
            "GZ": "Gazebo",
            "PY": "Private Gym",
            "PJ": "Jacuzzi",
            "BK": "Kitchen Appliances",
            "MR": "Maids Room",
            "MB": "Marble floors",
            "HF": "On high floor",
            "LF": "On low floor",
            "MF": "On mid floor",
            "PA": "Pets allowed",
            "GA": "Private garage",
            "PG": "Garden",
            "PP": "Swimming pool",
            "SA": "Sauna",
            "SP": "Shared swimming pool",
            "WF": "Wood flooring",
            "SR": "Steam room",
            "ST": "Study",
            "UI": "Upgraded interior",
            "GR": "Garden view",
            "VW": "Sea/Water view",
            "SE": "Security",
            "MT": "Maintenance",
            "IC": "Within a Compound",
            "IS": "Indoor swimming pool",
            "SF": "Separate entrance for females",
            "BT": "Basement",
            "SG": "Storage room",
            "CV": "Community view",
            "GV": "Golf view",
            "CW": "City view",
            "NO": "North orientation",
            "SO": "South orientation",
            "EO": "East orientation",
            "WO": "West orientation",
            "NS": "Near school",
            "HO": "Near hospital",
            "TR": "Terrace",
            "NM": "Near mosque",
            "SM": "Near supermarket",
            "ML": "Near mall",
            "PT": "Near public transportation",
            "MO": "Near metro",
            "VT": "Near veterinary",
            "BC": "Beach access",
            "PK": "Public parks",
            "RT": "Near restaurants",
            "NG": "Near Golf",
            "AP": "Near airport",
            "CS": "Concierge Service",
            "SS": "Spa",
            "SY": "Shared Gym",
            "MS": "Maid Service",
            "WC": "Walk-in Closet",
            "HT": "Heating",
            "GF": "Ground floor",
            "SV": "Server room",
            "DN": "Pantry",
            "RA": "Reception area",
            "VP": "Visitors parking",
            "OP": "Office partitions",
            "SH": "Core and Shell",
            "CD": "Children daycare",
            "CL": "Cleaning services",
            "NH": "Near Hotel",
            "CR": "conference room",
            "BL": "View of Landmark",
            "PR": "Children Play Area",
            "BH": "Beach Access"
        };
        document.getElementById('addPropertiesButton').addEventListener('click', async () => {
            const fileInput = document.getElementById('xmlFile');
            const textArea = document.getElementById('xmlContent');
            let xmlString = '';

            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                xmlString = await file.text();
            } else if (textArea.value.trim()) {
                xmlString = textArea.value.trim();
            } else {
                alert('Please upload an XML file or paste XML content.');
                return;
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlString, 'text/xml');

                // Check for parser errors
                if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
                    console.error('Error parsing XML:', xmlDoc.getElementsByTagName('parsererror')[0]);
                    alert('Error parsing XML. Please check the format.');
                    return;
                }

                const properties = xmlDoc.getElementsByTagName('property');
                const batch = db.batch();
                const addedProperties = [];
                const duplicateProperties = [];

                for (let i = 0; i < properties.length; i++) {
                    try {
                        const property = properties[i];
                        const permitNumber = property.getElementsByTagName('permit_number')?.[0]?.textContent || '';
                        const title = property.getElementsByTagName('title_en')?.[0]?.textContent || '';
                        const referenceNumber = property.getElementsByTagName('reference_number')?.[0]?.textContent || '';
                        const offeringType = property.getElementsByTagName('offering_type')?.[0]?.textContent || '';
                        const offplan = false; // Set offplan to false always
                        // Check if permitNumber is valid
                        if (!permitNumber) {
                            console.error(`Property ${i + 1}: Missing permit_number`);
                            alert(`Property ${i + 1}: Missing permit_number`);
                            continue;
                        }

                        const existingProperty = await db.collection('propertyListings').doc(permitNumber).get();
                        if (existingProperty.exists) {
                            duplicateProperties.push(title);
                            continue;
                        }

                        let propertyType = property.getElementsByTagName('property_type')?.[0]?.textContent || '';
                        switch (propertyType) {
                            case 'AP': propertyType = 'Apartment'; break;
                            case 'VH': propertyType = 'Villa'; break;
                            case 'PH': propertyType = 'Penthouse'; break;
                            case 'TH': propertyType = 'Townhouse'; break;
                            default: propertyType = 'Unknown';
                        }

                        const rawAmenities = property.getElementsByTagName('amenities')?.[0]?.textContent.split(',') || [];
                        const amenities = rawAmenities.map(code => amenitiesMapping[code.trim()] || code.trim());

                        const city = property.getElementsByTagName('city')?.[0]?.textContent || '';
                        const community = property.getElementsByTagName('community')?.[0]?.textContent || '';
                        const subCommunity = property.getElementsByTagName('sub_community')?.[0]?.textContent || '';
                        const propertyName = property.getElementsByTagName('property_name')?.[0]?.textContent || '';

                        const location = {
                            unitNo: property.getElementsByTagName('unit_number')?.[0]?.textContent || '',
                            address: `${propertyName}, ${subCommunity}, ${community}, ${city}`,
                            geoPoint: {
                                lat: parseFloat(property.getElementsByTagName('geopoints')?.[0]?.textContent.split(',')[1]) || 0,
                                lng: parseFloat(property.getElementsByTagName('geopoints')?.[0]?.textContent.split(',')[0]) || 0
                            }
                        };

                        const media = {
                            images: Array.from(property.getElementsByTagName('url')).map(url => url?.textContent || ''),
                            videoTour: property.getElementsByTagName('video_tour')?.[0]?.textContent || '',
                            tour360: property.getElementsByTagName('tour_360')?.[0]?.textContent || '',
                        };

                        const permit = {
                            reraListingNo: permitNumber,
                            dtcmPermitNo: 'N/A',
                            permitFromDate: null,
                            permitToDate: null,
                            type: 'RERA'
                        };

                        const management = {
                            id: property.getElementsByTagName('agent')?.[0]?.getElementsByTagName('id')?.[0]?.getElementsByTagName('name')?.[0]?.textContent || '',
                            assignedUser: property.getElementsByTagName('agent')?.[0]?.getElementsByTagName('id')?.[0]?.getElementsByTagName('email')?.[0]?.textContent || '',
                            agentPhone: property.getElementsByTagName('agent')?.[0]?.getElementsByTagName('id')?.[0]?.getElementsByTagName('phone')?.[0]?.textContent || '',
                            agentLicenseNo: property.getElementsByTagName('agent')?.[0]?.getElementsByTagName('id')?.[0]?.getElementsByTagName('license_no')?.[0]?.textContent || '',
                            agentPhoto: property.getElementsByTagName('agent')?.[0]?.getElementsByTagName('id')?.[0]?.getElementsByTagName('photo')?.[0]?.textContent || ''
                        };

                        const pricing = {
                            salePrice: parseFloat(property.getElementsByTagName('price')?.[0]?.textContent || '0'),
                            price: parseFloat(property.getElementsByTagName('price')?.[0]?.textContent || '0'),
                            priceOnApplication: property.getElementsByTagName('price_on_application')?.[0]?.textContent || 'No',
                            rentalPeriod: property.getElementsByTagName('rental_period')?.[0]?.textContent || null,
                        };

                        const furnished = property.getElementsByTagName('furnished')?.[0]?.textContent || 'No';
                        const parking = property.getElementsByTagName('parking')?.[0]?.textContent || '0';

                        const propertyData = {
                            title,
                            referenceNumber,
                            offeringType,
                            propertyType,
                            description: property.getElementsByTagName('description_en')?.[0]?.textContent || '',
                            bedrooms: parseInt(property.getElementsByTagName('bedroom')?.[0]?.textContent || '0'),
                            bathrooms: parseInt(property.getElementsByTagName('bathroom')?.[0]?.textContent || '0'),
                            amenities,
                            size: parseFloat(property.getElementsByTagName('size')?.[0]?.textContent || '0'),
                            completionStatus: property.getElementsByTagName('completion_status')?.[0]?.textContent || '',
                            city,
                            community,
                            subCommunity,
                            propertyName,
                            location,
                            media,
                            permit,
                            management,
                            pricing,
                            furnished,
                            parking,
                            offplan // Add the offplan field to the property data
                        };

                        const docRef = db.collection('propertyListings').doc(permitNumber);
                        batch.set(docRef, propertyData);
                        addedProperties.push(title);

                        const progress = Math.round(((i + 1) / properties.length) * 100);
                        updateProgressBar(progress);
                    } catch (err) {
                        console.error(`Error processing property ${i + 1}:`, err);
                        continue;
                    }
                }

                await batch.commit();
                displayAddedProperties(addedProperties);
                if (duplicateProperties.length > 0) {
                    displayDuplicateProperties(duplicateProperties);
                }

                alert('Properties added successfully!');
            } catch (error) {
                console.error('Error adding properties:', error);
                alert('Failed to add properties. Please check the XML format and try again.');
            }
        });

        // Function to display duplicate properties in red
        function displayDuplicateProperties(duplicateProperties) {
            const resultContainer = document.getElementById('resultContainer');
            duplicateProperties.forEach(title => {
                const titleElement = document.createElement('div');
                titleElement.textContent = `Duplicate: ${title}`;
                titleElement.style.color = 'red';
                resultContainer.appendChild(titleElement);
            });
        }

        function updateProgressBar(progress) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = `${progress}%`;
            progressBar.textContent = `${progress}%`;
        }

        function displayAddedProperties(properties) {
            const list = document.getElementById('addedPropertiesList');
            list.innerHTML = '';
            properties.forEach(property => {
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item';
                listItem.textContent = property;
                list.appendChild(listItem);
            });
        }
        //Data table script
        document.addEventListener('DOMContentLoaded', function () {
            const enquiriesTableBody = document.getElementById('enquiries-table-body');
            const contactFormSection = document.getElementById('ContactFormData');
            let dataTableInstance; // Store DataTable instance

            // Function to fetch data from Firestore and populate the table
            function fetchEnquiries() {
                db.collection('contactFormSubmissions')
                    .get()
                    .then((querySnapshot) => {
                        const enquiriesData = [];

                        if (querySnapshot.empty) {
                            enquiriesTableBody.innerHTML = '<tr><td colspan="11" class="text-center">No enquiries found</td></tr>';
                            return;
                        }

                        querySnapshot.forEach((doc) => {
                            const data = doc.data();
                            const formattedDate = new Date(data.dateSubmitted).toLocaleDateString() || 'N/A';
                            const rowData = [
                                formattedDate,
                                data.name || 'N/A',
                                data.email || 'N/A',
                                data.phone || 'N/A',
                                data.message || 'N/A',
                                data.community || 'N/A',
                                data.subCommunity || 'N/A',
                                data.building || 'N/A',
                                data.referenceNumber || 'N/A',
                                `<a href="${data.propertyLink}" target="_blank">View</a>`,
                                data.ipAddress || 'N/A'
                            ];

                            enquiriesData.push(rowData);
                        });

                        // Clear the existing DataTable (if already initialized)
                        if (dataTableInstance) {
                            dataTableInstance.clear().rows.add(enquiriesData).draw(); // Update DataTable with new data
                        } else {
                            // Initialize DataTable if not already done
                            dataTableInstance = $('#enquiries-table').DataTable({
                                data: enquiriesData, // Load data into DataTable
                                responsive: true,
                                paging: true,
                                searching: true,
                                ordering: true,
                                columns: [
                                    { title: "Date" },
                                    { title: "Name" },
                                    { title: "Email" },
                                    { title: "Phone" },
                                    { title: "Client Message" },
                                    { title: "Community" },
                                    { title: "Sub Community" },
                                    { title: "Building" },
                                    { title: "Reference Number" },
                                    { title: "Link" },
                                    { title: "IP Address" }
                                ],
                                columnDefs: [
                                    {
                                        targets: 0, // Date column
                                        type: 'date',
                                        render: function (data, type, row) {
                                            if (type === 'sort' || type === 'type') {
                                                return new Date(data).getTime(); // Sort by timestamp
                                            }
                                            return data; // Default display
                                        }
                                    }
                                ]
                            });
                        }

                        contactFormSection.style.display = 'block'; // Show section after loading
                    })
                    .catch((error) => {
                        console.error('Error fetching enquiries: ', error);
                    });
            }

            // Call the fetch function to load the enquiries when the page loads
            fetchEnquiries();
        });


        document.addEventListener('DOMContentLoaded', function () {
            const dropdownData = {
                bedrooms: [
                    { value: 0, label: "Studio" },
                    { value: 1, label: "1" },
                    { value: 2, label: "2" },
                    { value: 3, label: "3" },
                    { value: 4, label: "4" },
                    { value: 5, label: "5" },
                ],
                bathrooms: [
                    { value: 1, label: "1" },
                    { value: 2, label: "2" },
                    { value: 3, label: "3" },
                    { value: 4, label: "4" },
                    { value: 5, label: "5" },
                ],
                furnishingType: [
                    { value: "Unfurnished", label: "Unfurnished" },
                    { value: "Semi-furnished", label: "Semi-furnished" },
                    { value: "Furnished", label: "Furnished" },
                ],

                propertyType: [
                    { "value": "Apartment / Flat", "label": "Apartment / Flat" },
                    { "value": "Bungalow", "label": "Bungalow" },
                    { "value": "Compound", "label": "Compound" },
                    { "value": "Duplex", "label": "Duplex" },
                    { "value": "Full Floor", "label": "Full Floor" },
                    { "value": "Half Floor", "label": "Half Floor" },
                    { "value": "Land / Plot", "label": "Land / Plot" },
                    { "value": "Penthouse", "label": "Penthouse" },
                    { "value": "Townhouse", "label": "Townhouse" },
                    { "value": "Villa / House", "label": "Villa / House" },
                    { "value": "Whole Building", "label": "Whole Building" },
                    { "value": "Short Term / Hotel Apartment", "label": "Short Term / Hotel Apartment" },
                    { "value": "Labor Camp", "label": "Labor Camp" },
                    { "value": "Bulk Units", "label": "Bulk Units" },
                    { "value": "Warehouse", "label": "Warehouse" },
                    { "value": "Factory", "label": "Factory" },
                    { "value": "Office Space", "label": "Office Space" },
                    { "value": "Retail", "label": "Retail" },
                    { "value": "Plot", "label": "Plot" },
                    { "value": "Shop", "label": "Shop" },
                    { "value": "Show Room", "label": "Show Room" },
                    { "value": "Staff Accommodation", "label": "Staff Accommodation" }
                ],


                propertyStatus: [
                    { value: "Off-Plan Primary", label: "Off-Plan Primary" },
                    { value: "Off-Plan Secondary", label: "Off-Plan Secondary" },
                    { value: "Ready Primary", label: "Ready Primary" },
                    { value: "Ready Secondary", label: "Ready Secondary" }
                ]
            };

            // Function to populate a dropdown from JSON data
            function populateDropdown(data, dropdownId) {
                const dropdown = document.getElementById(dropdownId);
                data.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.value;
                    option.textContent = item.label;
                    dropdown.appendChild(option);
                });
            }

            // Populate the dropdowns
            populateDropdown(dropdownData.bedrooms, 'bedrooms');
            populateDropdown(dropdownData.bathrooms, 'bathrooms');
            populateDropdown(dropdownData.furnishingType, 'furnishingType');
            populateDropdown(dropdownData.propertyType, 'propertyType');
            populateDropdown(dropdownData.propertyStatus, 'propertyStatus');

            // Toggle visibility of Property Status based on Transaction Type
            function togglePropertyStatus() {
                const saleSelected = document.querySelector('input[name="transactionType"]:checked').value === 'Sale';
                const propertyStatusContainer = document.getElementById('propertyStatusContainer');
                propertyStatusContainer.style.display = saleSelected ? 'block' : 'none';
            }

            // Add event listeners to radio buttons for transaction type
            document.querySelectorAll('input[name="transactionType"]').forEach(radio => {
                radio.addEventListener('change', togglePropertyStatus);
            });
        });


    </script>

    <style>
        /* Add this CSS to handle the sidebar width and prevent overlap */
        @media (min-width: 992px) {
            #sidebarMenu {
                width: 240px;
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                z-index: 999;
                /* Ensure it appears above the content */
                background-color: #fff;
                /* Add background color */
            }

            #main-navbar {
                margin-left: 240px;
                /* Adjust the navbar to account for the sidebar */
            }

            main {
                margin-left: 240px;
                /* Adjust the main content area */
                padding: 20px;
                /* Add some padding for spacing */
            }
        }

        @media (max-width: 991px) {

            /* On smaller screens, collapse the sidebar */
            #sidebarMenu {
                position: relative;
                width: 100%;
                height: auto;
            }

            #main-navbar {
                margin-left: 0;
            }

            main {
                margin-left: 0;
                padding: 15px;
                /* Add padding for mobile responsiveness */
            }
        }
    </style>
    <script src="Scripts/rent_salePropertAdd.js"></script>
</body>

</html>